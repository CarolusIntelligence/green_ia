import numpy as np
import pandas as pd
import os
from sklearn.preprocessing import MinMaxScaler
import warnings
import json
import re
import sys

pd.set_option('display.max_rows', 100)
warnings.filterwarnings("ignore", category=pd.errors.DtypeWarning)
pd.set_option('future.no_silent_downcasting', True)


def count_chunks(jsonl_02, chunk_size):
    with open(jsonl_02, 'r') as file:
        line_count = sum(1 for _ in file)
    estimated_chunks = (line_count + chunk_size - 1) // chunk_size
    print(f"total chunk estimated: {estimated_chunks}")
    return estimated_chunks

def delete_file(file_path):
    if os.path.exists(file_path):
        os.remove(file_path)
        print(f"file deleted: {file_path}")
    else:
        print(f"ERROR, does not exists: {file_path}")

def rename_columns_processing(df): 
    df.rename(columns={'pnns_groups_1': 'groups'}, inplace=True)
    df.rename(columns={'ingredients_tags': 'ingredients_temp'}, inplace=True)
    df.rename(columns={'product_name': 'name'}, inplace=True)
    df.rename(columns={'categories_tags': 'categories_temp'}, inplace=True)
    df.rename(columns={'labels_tags': 'labels_temp'}, inplace=True)
    return df

def countries_processing(df, values_to_replace): 
    def clean_abrev(texte):
        if isinstance(texte, str):
            return re.sub(r'\b\w{2}:\b', '', texte).strip()
        return texte
    country_mapping = {
        'Ã¥land': 'finland',
        'european-union': 'europe',
        'cap-vert': 'cape verde',
        'repÃºblica de china': 'china',
        'sudÃ¡n': 'sudan',
        'scotland': 'united kingdom',
        'nueva zelanda': 'new zealand',
        'libye': 'libya',
        'Ğ²ĞµĞ»Ğ¸ĞºĞ¾Ğ±Ñ€Ğ¸Ñ‚Ğ°Ğ½Ğ¸Ñ': 'united kingdom',
        'Ø±ÙˆÙ…Ø§Ù†ÙŠØ§': 'romania',
        'burundi': 'burundi',
        'galmudug': 'somalia',
        'Ã¸strig': 'austria',
        'holland': 'netherlands',
        'libya': 'libya',
        'bahrain': 'bahrain',
        'islanda': 'iceland',
        'belgica': 'belgium',
        'irsko': 'ireland',
        'Î²Î¿Ï…Î»Î³Î±ÏÎ¯Î±': 'bulgaria',
        'Ğ³ÑŠÑ€Ñ†Ğ¸Ñ': 'greece',
        'islandia': 'iceland',
        'olanda': 'netherlands',
        'worldwide': 'world',
        'malawi': 'malawi',
        'bÃ©nin': 'benin',
        'shqipÃ«ria': 'albania',
        'republic-of-macedonia': 'north macedonia',
        'ÑĞµĞ²ĞµÑ€Ğ½Ğ° Ğ¼Ğ°ĞºĞµĞ´Ğ¾Ğ½Ğ¸Ñ': 'north macedonia',
        'Ğ°Ğ»Ğ±Ğ°Ğ½Ğ¸Ñ': 'albania',
        'Ğ±ĞµĞ»Ğ³Ğ¸Ñ˜Ğ°': 'belgium',
        'democratic-republic-of-the-congo': 'democratic republic of the congo',
        'ghana': 'ghana',
        'europese unie': 'europe',
        'volksrepubliek china': 'china',
        'united-arab-emirates': 'united arab emirates',
        'armÃ©nia': 'armenia',
        'norvegia': 'norway',
        'novÃ½ zÃ©land': 'new zealand',
        'portugali': 'portugal',
        'albÃ¢nia': 'albania',
        'ierland': 'ireland',
        'poÄ¾sko': 'poland',
        'nyderlandai': 'netherlands',
        'central african republic': 'central african republic',
        'algieria': 'algeria',
        'boÅ›nia i hercegowina': 'bosnia and herzegovina',
        'chorwacja': 'croatia',
        'rosja': 'russia',
        'benin': 'benin',
        'spanish': 'spain', 
        'fr': 'france', 
        "people's republic of china": 'china', 
        'es': 'spain',
        'america': "united states",
        'ca': 'canada', 
        'be': 'belgium', 
        'iraqi kurdistan': 'irak', 
        'turks and caicos islands': 'turkey',
        'indian subcontinent': 'india', 
        'san marino': 'italy', 
        'sicily': 'italy',
        'all countries': 'world',
        'vatican city': 'italy',
        'sudÃ¡frica': 'south africa',
        'Ã¡frica do sul': 'south africa',
        'benÃ­n': 'benin',
        'belÃ§ika': 'belgium',
        'iÌ‡sviÃ§re': 'switzerland',
        'ĞºĞ¾Ñ‚ Ğ´\'Ğ¸Ğ²Ğ¾Ğ°Ñ€': 'ivory coast',
        'ĞºÑƒĞ²ĞµĞ¹Ñ‚': 'kuwait',
        'Ğ»ÑĞºÑĞµĞ¼Ğ±ÑƒÑ€Ğ³': 'luxembourg',
        'paquistÃ£o': 'pakistan',
        'gibraltar': 'united kingdom',
        'iraque': 'iraq',
        'nemÄija': 'germany',
        'grÄija': 'greece',
        'luksemburg': 'luxembourg',
        'Å¡panija': 'spain',
        'montÃ©nÃ©gro': 'montenegro',
        'kenya': 'kenya',
        'portugalia': 'portugal',
        'azerbaÃ¯djan': 'azerbaijan',
        'malte': 'malta',
        'kroatia': 'croatia',
        'sveits': 'switzerland',
        'guinea': 'united states',
        'Õ°Õ¡ÕµÕ¡Õ½Õ¿Õ¡Õ¶': 'armenia',
        'estonsko': 'estonia',
        'kuwejt': 'kuwait',
        'bulgaaria': 'bulgaria',
        'rumeenia': 'romania',
        'ÑĞ»Ğ¾Ğ²ĞµĞ½Ğ¸Ñ˜Ğ°': 'slovenia',
        'thajsko': 'thailand',
        'à¸ªà¸²à¸˜à¸²à¸£à¸“à¸£à¸±à¸à¹€à¸Šà¹‡à¸': 'czech republic',
        'à¸›à¸£à¸°à¹€à¸—à¸¨à¸ªà¹‚à¸¥à¸§à¸²à¹€à¸à¸µà¸¢': 'slovakia',
        'Ğ¼Ğ°Ñ’Ğ°Ñ€ÑĞºĞ°': 'hungary',
        'namibia': 'namibia',
        'niger': 'niger',
        'namibie': 'namibia',
        'sudafrica': 'south africa',
        'botswana': 'botswana',
        'tanzania': 'tanzania',
        'algerie': 'algeria',
        'republic of the congo': 'republic of the congo',
        'rÃ©publique centrafricaine': 'central african republic',
        'guinÃ©e Ã©quatoriale': 'united states',
        'wybrzeÅ¼e koÅ›ci sÅ‚oniowej': 'ivory coast',
        'costa d\'avorio': 'ivory coast',
        'tunezja': 'tunisia',
        'tunesiÃ«': 'tunisia',
        'brunei': 'brunei',
        'Ù…ØµØ±': 'egypt',
        'Ø§ÛŒØ§Ù„Ø§Øª Ù…ØªØ­Ø¯Ù‡ Ø¢Ù…Ø±ÛŒÚ©Ø§': 'united states',
        'soomaaliya': 'somalia',
        'katar': 'qatar',
        'Ø³ÙˆØ±ÙŠØ§': 'syria',
        'Ø§Ù„ÙŠÙ…Ù†': 'yemen',
        'yemen': 'yemen',
        'venÃ¤jÃ¤': 'russia',
        'finsko': 'finland',
        'viro': 'estonia',
        'salvador': 'el salvador',
        'è‹±å›½': 'united kingdom',
        'turquÃ­a': 'turkey',
        'bosnia y herzegovina': 'bosnia and herzegovina',
        'bÃ³snia e herzegovina': 'bosnia and herzegovina',
        'turquia': 'turkey',
        'irlanti': 'ireland',
        'ruoÅ§Å§a': 'sweden',
        'sri-lanka': 'sri lanka',
        'se': 'sweden',
        'an fhraing': 'france',
        'a\' ghearmailt': 'germany',
        'poblachd na h-Ã¨ireann': 'ireland',
        'an rÃ¬oghachd aonaichte': 'united kingdom',
        'dominican-republic': 'dominican republic',
        'messico': 'mexico',
        'indien': 'india',
        'benelux': 'benelux',
        'new-zealand': 'new zealand',
        'ÙØ±Ø§Ù†Ø³': 'france',
        'Ø¬Ù…ÛÙˆØ±ÛŒÛ Ø¢Ø¦Ø±Ø³ØªØ§Ù†': 'ireland',
        'Ù¾Ø§Ú©Ø³ØªØ§Ù†': 'pakistan',
        'Ø±ÛŒØ§Ø³ØªÛØ§Ø¦Û’ Ù…ØªØ­Ø¯Û Ø¢Ù…Ø±ÛŒÚ©Ø§': 'united states',
        'Ñ€ĞµĞ¿ÑƒĞ±Ğ»Ğ¸ĞºĞ° Ğ¼Ğ°ĞºĞµĞ´Ğ¾Ğ½Ğ¸Ñ˜Ğ°': 'north macedonia',
        'la-reunion': 'reunion',
        'portugalsko': 'portugal',
        'kolumbien': 'colombia',
        'mauritania': 'mauritania',
        'isle of man': 'united kingdom',
        'haitÃ­': 'haiti',
        'cile': 'chile',
        'Ã©quateur': 'ecuador',
        'brasilien': 'brazil',
        'br': 'brazil',
        'Ã­rÃ¡n': 'iran',
        '×¦×¨×¤×ª': 'france',
        '××™×˜×œ×™×”': 'italy',
        'principato di monaco': 'monaco',
        'repubblica ceca': 'czech republic',
        'letÃ³nia': 'latvia',
        'guadalupa': 'reunion',
        'cipro': 'cyprus',
        'macedonia del norte': 'north macedonia',
        'finska': 'finland',
        'algerije': 'algeria',
        'spanyolorszÃ¡g': 'hungary',
        'dÃ¡nmÃ¡rku': 'denmark',
        'Î²Î­Î»Î³Î¹Î¿': 'belgium',
        'guiana francesa': 'french guiana',
        'polinÃ©sia francesa': 'french polynesia',
        'jordÃ¢nia': 'jordan',
        'north korea': 'north korea',
        'à¸›à¸£à¸°à¹€à¸—à¸¨à¸ˆà¸µà¸™': 'china',
        'islÃ¢ndia': 'iceland',
        'zuid-afrika': 'south africa',
        'letonia': 'latvia',
        'repÃºblica democrÃ¡tica del congo': 'democratic republic of the congo',
        'santoÃ±a': 'spain',
        'cantabria': 'spain',
        'france spain': 'france',
        'costa do marfim': 'ivory coast',
        'tÃºnez': 'tunisia',
        'Ğ¿Ğ¾Ñ€Ñ‚ÑƒĞ³Ğ°Ğ»Ğ¸Ñ': 'portugal',
        'tunesien': 'tunisia',
        'ÑƒĞ³Ğ¾Ñ€Ñ‰Ğ¸Ğ½Ğ°': 'hungary',
        'Ñ–Ñ‚Ğ°Ğ»Ñ–Ñ': 'italy',
        'Ñ–ÑĞ¿Ğ°Ğ½Ñ–Ñ': 'spain',
        'Ğ¼Ğ°Ñ€Ğ¾ĞºĞºĞ¾': 'morocco',
        'mÃ³naco': 'monaco',
        'jordania': 'jordan',
        'cabo verde': 'cape verde',
        'franca': 'france',
        'Î¹ÏƒÏ€Î±Î½Î¯Î±': 'spain',
        'arÃ¡bia saudita': 'saudi arabia',
        'andora': 'andorra',
        'maldives': 'maldives',
        'tunisko': 'tunisia',
        'martinik': 'martinique',
        'bosnia-and-herzegovina': 'bosnia and herzegovina',
        'ÑˆĞ²Ğ°Ñ˜Ñ†Ğ°Ñ€ÑĞºĞ°': 'switzerland',
        'bosnie-herzÃ©govine': 'bosnia and herzegovina',
        'ĞºĞ¸Ğ¿Ğ°Ñ€': 'cyprus',
        'tÃ¼rkei': 'turkey',
        'ØªØ±ÙƒÙŠØ§': 'turkey',
        'amerika birleÅŸik devletleri': 'united states',
        'Å™ecko': 'greece',
        'royaume uni': 'united kingdom',
        'cz': 'czech republic',
        'singapura': 'singapore',
        'frankriika': 'france',
        'nuova zelanda': 'new zealand',
        'kroatiÃ«': 'croatia',
        'elfenbeinkÃ¼ste': 'ivory coast',
        'philippinen': 'philippines',
        'palestinian territories': 'palestine',
        'Ã­ndia': 'india',
        'nova caledÃ³nia': 'australia',
        'moldavsko': 'moldova',
        'slovinsko': 'slovenia',
        'í”„ë‘ìŠ¤': 'france',
        'ë…ì¼': 'germany',
        'filipini': 'philippines',
        'juÅ¾na koreja': 'south korea',
        'zuid-korea': 'south korea',
        'corea del sud': 'south korea',
        'ìºë‚˜ë‹¤': 'canada',
        'ë„¤ëœë€ë“œ': 'netherlands',
        'tÅ¡ekki': 'czech republic',
        'cambogia': 'cambodia',
        'saudi-arabia': 'saudi arabia',
        'laos': 'laos',
        'ÑĞ¾ĞµĞ´Ğ¸Ğ½Ñ‘Ğ½Ğ½Ñ‹Ğµ ÑˆÑ‚Ğ°Ñ‚Ñ‹ Ğ°Ğ¼ĞµÑ€Ğ¸ĞºĞ¸': 'united states',
        'à¸›à¸£à¸°à¹€à¸—à¸¨à¸à¸±à¸¡à¸à¸¹à¸Šà¸²': 'cambodia',
        'kamerun': 'cameroon',
        'à¸›à¸£à¸°à¹€à¸—à¸¨à¸­à¸´à¸™à¹‚à¸”à¸™à¸µà¹€à¸‹à¸µà¸¢': 'indonesia',
        'timor-leste': 'timor-leste',
        'wereld': 'world',
        'fiji': 'fiji',
        'à¸›à¸£à¸°à¹€à¸—à¸¨à¹à¸„à¸™à¸²à¸”à¸²': 'canada',
        'à¸›à¸£à¸°à¹€à¸—à¸¨à¸ªà¸´à¸‡à¸„à¹‚à¸›à¸£à¹Œ': 'singapore',
        'bangladÃ©s': 'bangladesh',
        'nepal': 'nepal',
        'phÃ¡p': 'france',
        'viá»‡t nam': 'vietnam',
        'irÃ¡n': 'iran',
        'kirgisistan': 'kyrgyzstan',
        'bosnien und herzegowina': 'bosnia and herzegovina',
        'albÃ¡nie': 'albania',
        'francia': 'france',
        'bosna a hercegovina': 'bosnia and herzegovina',
        'saÃºdskÃ¡ arÃ¡bie': 'saudi arabia',
        'evropska unija': 'europe',
        'æ¾³å¤§åˆ©äºš': 'australia',
        'wallis and futuna': 'wallis and futuna',
        'Ø§Ù„Ø¨Ø­Ø±ÙŠÙ†': 'bahrain',
        'cook islands': 'cook islands',
        'fidji': 'fiji',
        'malaisie': 'malaysia',
        'anguilla': 'anguilla',
        'montserrat': 'montserrat',
        'Ğ³Ğ°Ğ±Ğ¾Ğ½': 'gabon',
        'almanya': 'germany',
        'ã‚¹ã‚¤ã‚¹': 'switzerland',
        'ÙØ±Ø§Ù†Ø³Ù‡': 'france',
        'Ø§ÛŒØ±Ø§Ù†': 'iran',
        'barÃ©in': 'bahrain',
        'fas': 'morocco',
        'nÃ©pal': 'nepal',
        'à¸›à¸£à¸°à¹€à¸—à¸¨à¹‚à¸à¸•à¸”à¸´à¸§à¸±à¸§à¸£à¹Œ': 'ivory coast',
        'saint lucia': 'saint lucia',
        'regatul unit al marii britanii È™i al irlandei de nord': 'united kingdom',
        'somalia': 'somalia',
        'rwanda': 'rwanda',
        'sierra leone': 'sierra leone',
        'nijer': 'niger',
        'brasile': 'brazil',
        'cehia': 'czech republic',
        'slovacia': 'slovakia',
        'ue': 'europe',
        'demokratickÃ¡ republika kongo': 'democratic republic of the congo',
        'nova kaledonien': 'australia',
        'jugoslavija': 'yugoslavia',
        'canadÃ ': 'canada',
        'turcia': 'turkey',
        'polynÃ©sie francaise': 'french polynesia',
        'Ğ±ĞµĞ»ÑŒĞ³Ñ–Ñ': 'belgium',
        'francjia': 'france',
        'antigua and barbuda': 'antigua and barbuda',
        'trinidad y tobago': 'trinidad and tobago',
        'republic of ireland': 'ireland',
        'frantsa': 'france',
        'Î³Î¿Ï…Î±Î´ÎµÎ»Î¿ÏÏ€Î·': 'reunion',
        'ÙƒÙˆØª Ø¯ÙŠÙÙˆØ§Ø±': 'ivory coast',
        'cina': 'china',
        'statele unite ale americii': 'united states',
        'hu': 'hungary',
        'ÑĞ»Ğ¾Ğ²ĞµĞ½Ğ¸Ñ': 'slovenia',
        'nieuw-caledoniÃ«': 'australia',
        'algÃ©ria': 'algeria',
        'marokkÃ³': 'morocco',
        'rÃ©publique de macÃ©doine': 'north macedonia',
        'macao': 'macau',
        'Ğ³Ñ€ĞµÑ†Ğ¸Ñ': 'greece',
        'lesotho': 'lesotho',
        'libanon': 'lebanon',
        'palÃ¤stinensische autonomiegebiete': 'palestine',
        'vereinigte arabische emirate': 'united arab emirates',
        'dz': 'algeria',
        'pf': 'french polynesia',
        'bg': 'bulgaria',
        'mo': 'macau',
        'sa': 'saudi arabia',
        'gn': 'united states',
        've': 'venezuela',
        'pe': 'peru',
        'th': 'thailand',
        'cl': 'chile',
        'nz': 'new zealand',
        'in': 'india',
        'au': 'australia',
        'id': 'indonesia',
        'gr': 'greece',
        'co': 'colombia',
        'ro': 'romania',
        'hk': 'hong kong',
        'rs': 'serbia',
        'dk': 'denmark',
        'ae': 'united arab emirates',
        'sc': 'seychelles',
        'middle east': 'middle east',
        'kasachstan': 'kazakhstan',
        'tn': 'tunisia',
        'ci': 'ivory coast',
        'kw': 'kuwait',
        'pt': 'portugal',
        'ar': 'argentina',
        'tw': 'taiwan',
        'ga': 'gabon',
        'tg': 'togo',
        'bh': 'bahrain',
        'pk': 'pakistan',
        'pa': 'panama',
        'etats-unis': 'united states',
        'mu': 'mauritius',
        'faroe islands': 'denmark',
        'ht': 'haiti',
        'ãƒ‰ã‚¤ãƒ„': 'germany',
        'za': 'south africa',
        'fi': 'finland',
        'litvÃ¡nia': 'lithuania',
        'ua': 'ukraine',
        'il': 'israel',
        'si': 'slovenia',
        'sk': 'slovakia',
        'south-africa': 'south africa',
        'east-germany': 'germany',
        'tr': 'turkey',
        'pl': 'poland',
        'mk': 'north macedonia',
        'Ã®le maurice': 'mauritius',
        'pr': 'puerto rico',
        'ne': 'niger',
        'cr': 'costa rica',
        'my': 'malaysia',
        'bj': 'benin',
        'ec': 'ecuador',
        'mt': 'malta',
        'vn': 'vietnam',
        'ba': 'bosnia and herzegovina',
        'qa': 'qatar',
        'by': 'belarus',
        'gd': 'grenada',
        'mx': 'mexico',
        'eg': 'egypt',
        'eu': 'europe',
        'cm': 'cameroon',
        'ng': 'nigeria',
        'ml': 'mali',
        'om': 'oman',
        'gt': 'guatemala',
        'grenada': 'grenada',
        'thaimaa': 'thailand',
        'lt': 'lithuania',
        'mr': 'mauritania',
        'papua new guinea': 'united states',
        'biaÅ‚oruÅ›': 'belarus',
        'ph': 'philippines',
        'itÃ lia': 'italy',
        'u.s.a': 'united states',
        'sv': 'el salvador',
        'kz': 'kazakhstan',
        'lv': 'latvia',
        'cg': 'congo',
        'arabia saudyjska': 'saudi arabia',
        'turcja': 'turkey',
        'saint martin': 'france',
        'bf': 'burkina faso',
        'bd': 'bangladesh',
        'gh': 'ghana',
        'mz': 'mozambique',
        'al': 'albania',
        'uz': 'uzbekistan',
        'pm': 'saint pierre and miquelon',
        'gy': 'guyana',
        'dj': 'djibouti',
        'uy': 'uruguay',
        'cd': 'democratic republic of the congo',
        'sowjetunion': 'soviet union',
        'frantzia': 'france',
        'espainia': 'spain',
        'mg': 'madagascar',
        'ke': 'kenya',
        'uae': 'united arab emirates',
        'td': 'chad',
        'mÃ©xico espaÃ±a': 'mexico spain',
        'az': 'azerbaijan',
        'norveÅ¡ka': 'norway',
        'republik kongo': 'republic of the congo',
        'np': 'nepal',
        'gi': 'gibraltar',
        'ad': 'andorra',
        'yugoslavia': 'serbia',
        'porto rico': 'puerto rico',
        'czechia': 'czech republic',
        'kr': 'south korea',
        'md': 'moldova',
        'à¸›à¸£à¸°à¹€à¸—à¸¨à¸™à¸´à¸§à¸‹à¸µà¹à¸¥à¸™à¸”à¹Œ': 'new zealand',
        'Ğ°Ğ±Ñ…Ğ°Ğ·Ğ¸Ñ': 'abkhazia',
        'zimbabwe': 'zimbabwe',
        'mc': 'monaco',
        'Ñ€ĞµĞ¿ÑƒĞ±Ğ»Ğ¸ĞºĞ° Ğ¸Ñ€Ğ»Ğ°Ğ½Ğ´Ğ¸Ñ': 'republic of ireland',
        'lr': 'liberia',
        'yt': 'mayotte',
        'cy': 'cyprus',
        'nowa kaledonia': 'australia',
        'je': 'jersey',
        'gg': 'guernsey',
        'hashemite kingdom of jordan': 'jordan',
        'lÃ«tzebuerg (land)': 'luxembourg',
        'santona': 'saint',
        'Ù‡ÙˆÙ„Ù†Ø¯Ø§': 'netherlands',
        'congo': 'congo',
        'ivory coast': 'cote d\'ivoire',
        'norsko': 'norway',
        'lc': 'saint lucia',
        'macedonia': 'north macedonia',
        'emirados Ã¡rabes unidos': 'united arab emirates',
        'tajlandia': 'thailand',
        'me': 'montenegro',
        'america': 'united states',
        'wf': 'wallis and futuna',
        'do': 'dominican republic',
        'united-states-of-america': 'united states',
        'indonesiÃ«': 'indonesia',
        'maleisiÃ«': 'malaysia',
        'filipijnen': 'philippines',
        'republika chiÅ„ska': 'china',
        'ge': 'georgia',
        'croazia': 'croatia',
        'uniunea europeanÄƒ': 'europe',
        'evropskÃ¡ unie': 'europe',
        'cape verde': 'cape verde',
        'szlovÃ©nia': 'slovenia',
        '++': 'unknown',
        'kolumbia': 'colombia',
        'ã‚¿ã‚¤ç‹å›½': 'thailand',
        'grekland': 'greece',
        'polinesia perancis': 'french polynesia',
        'libano': 'lebanon',
        'usbekistan': 'uzbekistan',
        'tadschikistan': 'tajikistan',
        'weiÃŸrussland': 'belarus',
        'republic-of-the-congo': 'republic of the congo',
        'ky': 'cayman islands',
        'republic of lithuania': 'lithuania',
        'ØªÙˆØºÙˆ': 'togo',
        'is': 'iceland',
        'bhutan': 'bhutan',
        'paraguai': 'paraguay',
        'uruguai': 'uruguay',
        'it:..': 'italy',
        'am': 'armenia',
        'è·è˜­': 'netherlands',
        'japÄna': 'japan',
        'japonija': 'japan',
        'ir': 'iran',
        'izrael': 'israel',
        'py': 'paraguay',
        'cu': 'cuba',
        'yu': 'serbia',
        'à¸›à¸£à¸°à¹€à¸—à¸¨à¸•à¸¸à¸£à¸à¸µ': 'turkey',
        'netherlands france': 'france',
        'Ã¤gypten': 'egypt',
        'lk': 'sri lanka',
        'Ñ‚ÑƒÑ€Ñ†Ğ¸Ñ': 'turkey',
        'palestine': 'palestine',
        'wyspy owcze': 'faroe islands',
        'Ğ¾ÑÑ‚Ñ€Ğ¾Ğ² Ñ€Ğ¾Ğ¶Ğ´ĞµÑÑ‚Ğ²Ğ°': 'christmas island',
        'hr': 'croatia',
        'Ã©tat unis': 'united states',
        'jo': 'jordan',
        'iq': 'iraq',
        'ni': 'nicaragua',
        'ãƒ‘ã‚­ã‚¹ã‚¿ãƒ³': 'pakistan',
        'ä¸­å›½': 'china',
        'american samoa': 'american samoa',
        'mm': 'myanmar',
        'cv': 'cape verde',
        'ÑĞ»Ğ¾Ğ²Ğ°ĞºĞ¸Ñ': 'slovakia',
        'km': 'comoros',
        'syrie': 'syria',
        'kambodscha': 'cambodia',
        'la': 'laos',
        'bn': 'brunei',
        'south america': 'south america',
        'turkije': 'turkey',
        'surinam': 'suriname',
        'ukrajina': 'ukraine',
        'vu': 'vanuatu',
        'filipinas': 'philippines',
        'm': 'unknown',
        'cypr': 'cyprus',
        'rÃ©publique dÃ©mocratique allemande': 'german democratic republic',
        'tunis': 'tunisia',
        'ĞµÑÑ‚Ğ¾Ğ½Ğ¸Ñ': 'estonia',
        'storbritannia': 'united kingdom',
        'tz': 'tanzania',
        'cw': 'curaÃ§ao',
        'bosnia': 'bosnia and herzegovina',
        'thailandia': 'thailand',
        'fo': 'faroe islands',
        'lenkija': 'poland',
        'ee': 'estonia',
        'costa-rica': 'costa rica',
        'republic of moldova': 'moldova',
        'na': 'namibia',
        'Ğ¾Ğ±ÑŠĞµĞ´Ğ¸Ğ½Ñ‘Ğ½Ğ½Ñ‹Ğµ Ğ°Ñ€Ğ°Ğ±ÑĞºĞ¸Ğµ ÑĞ¼Ğ¸Ñ€Ğ°Ñ‚Ñ‹': 'united arab emirates',
        'unione europea': 'europe',
        'beÄ¼Ä£ija': 'belgium',
        'caribisch nederland': 'caribbean netherlands',
        'south-korea': 'south korea',
        'el-salvador': 'el salvador',
        'spÃ¡nia': 'spain',
        'Ø§Ù„ÙƒØ§Ù…ÙŠØ±ÙˆÙ†': 'cameroon',
        'santa lucÃ­a': 'saint lucia',
        'romanya': 'romania',
        'iÌ‡spanya': 'spain',
        'reino-unido': 'united kingdom',
        'curazao': 'curaÃ§ao',
        'ÑƒĞ·Ğ±ĞµĞºĞ¸ÑÑ‚Ğ°Ğ½': 'uzbekistan',
        'guayana francesa': 'french guiana',
        'mv': 'maldives',
        'bosznia-hercegovina': 'bosnia and herzegovina',
        'Ã©sztorszÃ¡g': 'estonia',
        'jm': 'jamaica',
        'et': 'ethiopia',
        'ao': 'angola',
        'sint maarten': 'sint maarten',
        'bulgarija': 'bulgaria',
        'chad': 'chad',
        'cezayir': 'algeria',
        'suopma': 'finland',
        'iraqi kurdistan': 'iraq',
        '---': 'unknown',
        'egipto': 'egypt',
        'caribbean netherlands': 'caribbean netherlands',
        'fr â‚¬': 'france',
        'zambia': 'zambia',
        'bs': 'bahamas',
        'cf': 'central african republic',
        'uganda': 'uganda',
        'sr': 'suriname',
        'gq': 'united states',
        'guinea ecuatorial': 'united states',
        'bb': 'barbados',
        'è¥¿ç­ç‰™': 'spain',
        'san martÃ­n': 'saint martin',
        'san vicente y las granadinas': 'saint vincent and the grenadines',
        'sx': 'sint maarten',
        'argentyna': 'argentina',
        'ukraina': 'ukraine',
        'san marino': 'san marino',
        'arabia sauditÄƒ': 'saudi arabia',
        'polinesia francese': 'french polynesia',
        'à¸›à¸£à¸°à¹€à¸—à¸¨à¹€à¸¡à¹‡à¸à¸‹à¸´à¹‚à¸': 'mexico',
        'pobÅ™eÅ¾Ã­ slonoviny': 'ivory coast',
        'spojenÃ© arabskÃ© emirÃ¡ty': 'united arab emirates',
        'gabun': 'gabon',
        'Ã¶sterrike': 'austria',
        'argentina - espaÃ±ol': 'argentina',
        'armenia - pyÑÑĞºĞ¸Ğ¹': 'armenia',
        'aruba - espaÃ±ol': 'aruba',
        'asia pacific': 'asia',
        'australia - english': 'australia',
        'austria - deutsch': 'austria',
        'azerbaijan - Ñ€ÑƒÑÑĞºĞ¸Ğ¹': 'azerbaijan',
        'belarus - pyÑÑĞºĞ¸Ğ¹': 'belarus',
        'belgium - franÃ§ais': 'belgium',
        'belgium - nederlands': 'belgium',
        'bolivia - espaÃ±ol': 'bolivia',
        'bosnia i hercegovina - bosnian': 'bosnia and herzegovina',
        'botswana - english': 'botswana',
        'brazil - portuguÃªs': 'brazil',
        'bulgaria - Ğ±ÑŠĞ»Ğ³Ğ°Ñ€ÑĞºĞ¸': 'bulgaria',
        'cambodia - english': 'cambodia',
        'cambodia - á—á¶áŸá¶ááŸ’á˜áŸ‚áš': 'cambodia',
        'canada - english': 'canada',
        'canada - franÃ§ais': 'canada',
        'chile - espaÃ±ol': 'chile',
        'china - ä¸­æ–‡': 'china',
        'colombia - espaÃ±ol': 'colombia',
        'costa rica - espaÃ±ol': 'costa rica',
        'croatia - hrvatski': 'croatia',
        'cyprus - ÎµÎ»Î»Î·Î½Î¹ÎºÎ¬': 'cyprus',
        'czech republic - ÄeÅ¡tina': 'czech republic',
        'denmark - dansk': 'denmark',
        'ecuador - espaÃ±ol': 'ecuador',
        'el salvador - espaÃ±ol': 'el salvador',
        'estonia - eesti': 'estonia',
        'europe': 'europe',
        'finland - suomi': 'finland',
        'france - franÃ§ais': 'france',
        'georgia - áƒ¥áƒáƒ áƒ—áƒ£áƒšáƒ˜': 'georgia',
        'germany - deutsch': 'germany',
        'ghana - english': 'ghana',
        'greece - ÎµÎ»Î»Î·Î½Î¹ÎºÎ¬': 'greece',
        'guatemala - espaÃ±ol': 'guatemala',
        'honduras - espaÃ±ol': 'honduras',
        'hong kong - ç²µèª': 'hong kong',
        'hungary - magyar': 'hungary',
        'iceland - Ã­slenska': 'iceland',
        'india - english': 'india',
        'indonesia - bahasa indonesia': 'indonesia',
        'ireland - english': 'ireland',
        'israel - ×¢×‘×¨×™×ª': 'israel',
        'italy - italiano': 'italy',
        'jamaica - english': 'jamaica',
        'japan - æ—¥æœ¬èª': 'japan',
        'kazakhstan - pyÑÑĞºĞ¸Ğ¹': 'kazakhstan',
        'korea - í•œêµ­ì–´': 'south korea',
        'kyrgyzstan - Ñ€ÑƒÑÑĞºĞ¸Ğ¹': 'kyrgyzstan',
        'latvia - latvieÅ¡u': 'latvia',
        'lebanon - english': 'lebanon',
        'lesotho - english': 'lesotho',
        'lithuania - lietuviÅ³': 'lithuania',
        'macau - ä¸­æ–‡': 'macau',
        'malaysia - bahasa melayu': 'malaysia',
        'malaysia - english': 'malaysia',
        'malaysia - ä¸­æ–‡': 'malaysia',
        'mexico - espaÃ±ol': 'mexico',
        'middle east & africa': 'middle east and africa',
        'moldova - romÃ¢n': 'moldova',
        'mongolia - Ğ¼Ğ¾Ğ½Ğ³Ğ¾Ğ» Ñ…ÑĞ»': 'mongolia',
        'namibia - english': 'namibia',
        'netherlands - nederlands': 'netherlands',
        'new zealand - english': 'new zealand',
        'nicaragua - espaÃ±ol': 'nicaragua',
        'north macedonia - Ğ¼Ğ°ĞºĞµĞ´Ğ¾Ğ½ÑĞºĞ¸ Ñ˜Ğ°Ğ·Ğ¸Ğº': 'north macedonia',
        'norway - norsk': 'norway',
        'panamÃ¡ - espaÃ±ol': 'panama',
        'paraguay - espaÃ±ol': 'paraguay',
        'perÃº - espaÃ±ol': 'peru',
        'philippines - english': 'philippines',
        'poland - polski': 'poland',
        'portugal - portuguÃªs': 'portugal',
        'puerto rico - espaÃ±ol': 'puerto rico',
        'repÃºblica dominicana - espaÃ±ol': 'dominican republic',
        'romania - romÃ¢nÄƒ': 'romania',
        'russia - Ñ€ÑƒÑÑĞºĞ¸Ğ¹': 'russia',
        'serbia - srpski': 'serbia',
        'singapore - english': 'singapore',
        'slovak republic - slovenÄina': 'slovakia',
        'slovenia - slovene': 'slovenia',
        'south africa -english': 'south africa',
        'spain - espaÃ±ol': 'spain',
        'swaziland - english': 'eswatini',
        'sweden - svenska': 'sweden',
        'switzerland - deutsch': 'switzerland',
        'switzerland - franÃ§ais': 'switzerland',
        'taiwan - ä¸­æ–‡': 'taiwan',
        'thailand - à¹„à¸—à¸¢': 'thailand',
        'trinidad & tobago - english': 'trinidad and tobago',
        'turkey - tÃ¼rkÃ§e': 'turkey',
        'ukraine - yĞºÑ€Ğ°Ñ—ÌĞ½ÑÑŒĞºĞ°': 'ukraine',
        'united kingdom - english': 'united kingdom',
        'united states - english': 'united states',
        'united states - espaÃ±ol': 'united states',
        'uruguay - espaÃ±ol': 'uruguay',
        'venezuela - espaÃ±ol': 'venezuela',
        'vietnam - tiáº¿ng viá»‡t': 'vietnam',
        'zambia - english': 'zambia',
        'mongolei': 'mongolia',
        'xk': 'kosovo',
        'zentralafrikanische republik': 'central african republic',
        'latinoamerica': 'latin america',
        'bermuda': 'bermuda',
        'zm': 'zambia',
        'pakistÃ¡n': 'pakistan',
        '5018 rue harwood': 'canada',
        'allemagne nazi': 'germany',
        'ÑˆĞ¿Ğ°Ğ½Ğ¸Ñ˜Ğ°': 'spain',
        'london': 'united kingdom',
        'sloveniÃ«': 'slovenia',
        'bhoutan': 'bhutan',
        'madagascar - toamasina': 'madagascar',
        'madÅ¾arska': 'hungary',
        'maurÃ­cia': 'mauritius',
        'tailÃ¢ndia': 'thailand',
        'ly': 'libya',
        'ãƒ™ãƒ«ã‚®ãƒ¼': 'belgium',
        'camerÃºn': 'cameroon',
        'gambia': 'gambia',
        'united states minor outlying islands': 'united states',
        'Ã­rorszÃ¡g': 'ireland',
        'Ğ»Ğ¸Ñ‚Ğ²Ğ°': 'lithuania',
        'itÃ¤valta': 'austria',
        'malasia': 'malaysia',
        'birmanie': 'myanmar',
        'camerun': 'cameroon',
        'liberia': 'liberia',
        'Ø§Ù„Ø³Ù†ØºØ§Ù„': 'senegal',
        'bahamas': 'bahamas',
        'amÃ©rica': 'america',
        'belleville wa': 'united states',
        'kazachstan': 'kazakhstan',
        'ps': 'palestine',
        'tt': 'trinidad and tobago',
        'ethiopia': 'ethiopia',
        'Ø§Ù„Ø§ØªØ­Ø§Ø¯ Ø§Ù„Ø£ÙˆØ±ÙˆØ¨ÙŠ': 'europe',
        'ryssland': 'russia',
        'Ã®les cook': 'cook islands',
        'fj': 'fiji',
        'ã‚«ãƒŠãƒ€': 'canada',
        'ÑƒÑ˜ĞµĞ´Ğ¸ÑšĞµĞ½Ğ¾ ĞºÑ€Ğ°Ñ™ĞµĞ²ÑÑ‚Ğ²Ğ¾': 'united kingdom',
        'ã‚µã‚¦ã‚¸ã‚¢ãƒ©ãƒ“ã‚¢': 'saudi arabia',
        'ÄernÃ¡ hora': 'montenegro',
        'coreia do sul': 'south korea',
        'chorvÃ¡tsko': 'croatia',
        'malezja': 'malaysia',
        'Ğ»Ğ¸Ğ±Ğ¸Ñ': 'libya',
        'liettua': 'lithuania',
        'oroszorszÃ¡g': 'hungary',
        'lux': 'luxembourg',
        'hn': 'honduras',
        'libia': 'libya',
        'brazylia': 'brazil',
        'korean tasavalta': 'south korea',
        'northern mariana islands': 'united states',
        'puerto-rico': 'united states',
        'ahvenanmaan maakunta': 'aland islands',
        'moldÃ¡via': 'moldova',
        'state of palestine': 'palestine',
        'unknown': 'unknown',
        'ã‚¤ã‚¿ãƒªã‚¢': 'italy',
        'azÉ™rbaycan': 'azerbaijan',
        'virgin-islands-of-the-united-states': 'united states',
        'Äekija': 'czech republic',
        'suedia': 'sweden',
        'guam': 'united states',
        'bq': 'bonaire',
        'france.': 'france',
        'bm': 'bermuda',
        'sudan': 'sudan',
        'yÃ©men': 'yemen',
        'north-macedonia': 'north macedonia',
        'belize': 'belize',
        'ãƒ¢ãƒ­ãƒƒã‚³': 'morocco',
        'egito': 'egypt',
        'Ø§Ù„Ø³ÙˆØ¯Ø§Ù†': 'sudan',
        'u.s.a.': 'united states',
        'pw': 'palau',
        'sambia': 'zambia',
        'ameriketako estatu batuak': 'united states',
        'soudan': 'sudan',
        'airija': 'ireland',
        '.': 'unknown',
        'bw': 'botswana',
        'equatorial guinea': 'united states',
        'ĞºĞ¸Ğ¿ÑŠÑ€': 'cyprus',
        'camboya': 'cambodia',
        'ss': 'south sudan',
        'gu': 'guam',
        'ai': 'anguilla',
        'meksiko': 'mexico',
        'saint vincent and the grenadines': 'saint vincent and the grenadines',
        'ĞºĞ¸Ñ‚Ğ°Ğ¹ÑĞºĞ°Ñ Ğ½Ğ°Ñ€Ğ¾Ğ´Ğ½Ğ°Ñ Ñ€ĞµÑĞ¿ÑƒĞ±Ğ»Ğ¸ĞºĞ°': 'china',
        'ã‚ªãƒ¼ã‚¹ãƒˆãƒ©ãƒªã‚¢': 'australia',
        'Î³ÎµÏÎ¼Î±Î½Î¯Î±': 'germany',
        'stato di palestina': 'palestine',
        'prepared for siwin foods edmonton alberta t6b 3v2': 'canada',
        'sierra-leone': 'sierra leone',
        'maldive': 'maldives',
        'pg': 'united states',
        'united states of america': 'united states',
        'monako': 'monaco',
        'finlanda': 'finland',
        'ÄeskÃ¡ republika': 'czech republic',
        'mn': 'mongolia',
        'ÎµÏ…ÏÏ‰Ï€Î±ÏŠÎºÎ® Î­Î½Ï‰ÏƒÎ·': 'europe',
        'greenland': 'denmark',
        'er': 'eritrea',
        'Ğ¾Ğ±ĞµĞ´Ğ¸Ğ½ĞµĞ½Ğ¸ Ğ°Ñ€Ğ°Ğ±ÑĞºĞ¸ ĞµĞ¼Ğ¸Ñ€ÑÑ‚Ğ²Ğ°': 'united arab emirates',
        'ãƒ«ã‚¯ã‚»ãƒ³ãƒ–ãƒ«ã‚¯': 'luxembourg',
        'ã‚¢ã‚¤ãƒ«ãƒ©ãƒ³ãƒ‰': 'ireland',
        'ãƒ‹ãƒ¥ãƒ¼ã‚¸ãƒ¼ãƒ©ãƒ³ãƒ‰': 'new zealand',
        'severnÃ­ makedonie': 'north macedonia',
        'Ù„ÙŠØªÙˆØ§Ù†ÙŠØ§': 'lithuania',
        'cipar': 'cyprus',
        'sm': 'san marino',
        'tunÃ©zia': 'tunisia',
        'repubblica dominicana': 'dominican republic',
        'colÃ´mbia': 'colombia',
        'aw': 'aruba',
        'sao tomÃ© and prÃ­ncipe': 'sao tome and principe',
        'à¦¯à§à¦•à§à¦¤à¦°à¦¾à¦œà§à¦¯': 'united kingdom',
        'comoros': 'comoros',
        'germa': 'germany',
        'moldawien': 'moldova',
        'Ğ¼Ğ°Ğ»Ñ‚Ğ°': 'malta',
        'hellas': 'greece',
        'ug': 'uganda',
        'ãƒ‹ãƒ¥ãƒ¼ã‚«ãƒ¬ãƒ‰ãƒ‹ã‚¢': 'australia',
        'aland-islands': 'aland islands',
        'vi': 'united states virgin islands',
        'rw': 'rwanda',
        'sardinia': 'italy',
        'ÑĞ¿Ğ¾Ğ½Ñ–Ñ': 'japan',
        'mannin': 'isle of man',
        'reeriaght unnaneysit': 'united kingdom',
        'republica mexicana': 'mexico',
        'republika poÅ‚udniowej afryki': 'south africa',
        'georgien': 'georgia',
        'å—ã‚¢ãƒ•ãƒªã‚«å…±å’Œå›½': 'south africa',
        'espagnol': 'spanish',
        'ye': 'yemen',
        'vatican city': 'vatican city',
        'indonesien': 'indonesia',
        'kn': 'saint kitts and nevis',
        'bo': 'bolivia',
        'en: espaÃ±a': 'spain',
        'ÑĞµĞ²ĞµÑ€Ğ½Ğ° Ğ¼Ğ°ĞºĞµĞ´Ğ¾Ğ½Ğ¸Ñ˜Ğ°': 'north macedonia',
        'Ğ°Ğ»Ğ±Ğ°Ğ½Ğ¸Ñ˜Ğ°': 'albania',
        'sy': 'syria',
        'im': 'isle of man',
        'beyaz rusya': 'belarus',
        'nowa zelandia': 'new zealand',
        'Ø§Ù„Ù…Ø¬Ø±': 'hungary',
        'norga': 'norway',
        'tjeckien': 'czech republic',
        'eeuu': 'united states',
        'birmania': 'myanmar',
        'Ğ¼Ğ°ĞºĞµĞ´Ğ¾Ğ½Ğ¸Ñ˜Ğ°': 'north macedonia',
        'sd': 'sudan',
        'Ğ»Ğ¸Ğ²Ğ°Ğ½': 'lebanon',
        'tasty foods Î±Î²Î³Îµ': 'greece',
        'ĞºĞ°Ğ¼ĞµÑ€ÑƒĞ½': 'cameroon',
        'Ğ¼Ğ¾Ğ½Ğ³Ğ¾Ğ» ÑƒĞ»Ñ': 'mongolia',
        'mp': 'northern mariana islands',
        'so': 'somalia',
        'Ñ€ÑƒÑĞ¸Ñ': 'russia',
        '::': 'unknown',
        'ã‚¤ãƒ©ã‚¯': 'iraq',
        'macedonia de nord': 'north macedonia',
        'lÃ­bia': 'libya',
        'japani': 'japan',
        'vg': 'british virgin islands',
        'ag': 'antigua and barbuda',
        'ä¸­è¯äººæ°‘å…±å’Œå›½': 'people\'s republic of china',
        'turkiye': 'turkey',
        'à¸›à¸£à¸°à¹€à¸—à¸¨à¸à¸µà¹ˆà¸›à¸¸à¹ˆà¸™': 'japan',
        'indian subcontinent': 'indian subcontinent',
        'ã‚¨ãƒ«ã‚µãƒ«ãƒãƒ‰ãƒ«': 'el salvador',
        'emirati arabi uniti': 'united arab emirates',
        'saint-marin': 'san marino',
        'british virgin islands': 'british virgin islands',
        'tjekkiet': 'czech republic',
        'æ„å¤§åˆ©': 'italy',
        'tonga': 'tonga',
        'obala bjelokosti': 'ivory coast',
        'wietnam': 'vietnam',
        'jamaÃ¯que': 'jamaica',
        'turks and caicos islands': 'turks and caicos islands',
        'moÃ§ambique': 'mozambique',
        'cc': 'cocos (keeling) islands',
        'filipiny': 'philippines',
        'kurdistan irakien': 'iraqi kurdistan',
        'va': 'vatican city',
        'serviÃ«': 'serbia',
        'æ²™ç‰¹é˜¿æ‹‰ä¼¯': 'saudi arabia',
        'zw': 'zimbabwe',
        'mondo': 'world',
        'macedonia del nord': 'north macedonia',
        'sl': 'sierra leone',
        'moldaviÃ«': 'moldova',
        'Ğ½Ğ¸Ğ´ĞµÑ€Ğ»Ğ°Ğ½Ğ´Ñ‹': 'netherlands',
        'kp': 'north korea',
        'iirimaa': 'ireland',
        'egitto': 'egypt',
        'islanti': 'iceland',
        'na stÃ itean aonaichte': 'united states',
        'bz': 'belize',
        'belice': 'belize',
        'bi': 'burundi',
        'bellingham wa usa': 'united states',
        'as': 'american samoa',
        'Ø§Ù„Ø§Ø±Ø¯Ù†': 'jordan',
        'dm': 'dominica',
        'ken': 'kenya',
        'ã‚¢ãƒ©ãƒ–é¦–é•·å›½é€£é‚¦': 'united arab emirates',
        'nyl': 'unknown',
        'samoa': 'samoa',
        'wit-rusland': 'belarus',
        'txekia': 'czech republic',
        'luxenburgo': 'luxembourg',
        'Ğ¸Ğ½Ğ´Ğ¸Ñ': 'india',
        'brazil france': 'france',
        'dÃ©l-korea': 'south korea',
        'bermudas': 'bermuda',
        'Ä«rija': 'ireland',
        'coquitlam bc': 'canada',
        'salwador': 'el salvador',
        'amerika syarikat': 'united states',
        'Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø¨Ù„Ø¯Ø§Ù†': 'all countries',
        'ĞºĞ¸Ñ€Ğ³Ğ¸Ğ·Ğ¸Ñ': 'kyrgyzstan',
        'kuba': 'cuba',
        'bih': 'bosnia and herzegovina',
        'Ğ°Ñ€Ğ¶ĞµĞ½Ñ‚Ğ¸Ğ½Ğ°': 'argentina',
        'Ğ¼Ğ¾Ğ»Ğ´Ğ¾Ğ²Ğ°': 'moldova',
        'indie': 'india',
        'omÃ¡n': 'oman',
        'sudÃ¡n del sur': 'south sudan',
        'ÑƒĞºÑ€Ğ°Ğ¹Ğ½Ğ°': 'ukraine',
        'Ğ´Ğ°Ğ½Ğ¸Ñ': 'denmark',
        'Ø¬Ù†ÙˆØ¨ Ø£ÙØ±ÙŠÙ‚ÙŠØ§': 'south africa',
        'japonsko': 'japan',
        'Ğ°Ñ€Ğ¼ĞµĞ½Ğ¸Ñ': 'armenia',
        'gm': 'gambia',
        'fiyi': 'fiji',
        'st': 'sÃ£o tomÃ© and prÃ­ncipe',
        'slov': 'unknown',
        'Å¡veice': 'switzerland',
        'ãƒ‡ãƒ³ãƒãƒ¼ã‚¯': 'denmark',
        'albaniÃ«': 'albania',
        'tc': 'turks and caicos islands',
        'Ø§Ù„Ù‡Ù†Ø¯': 'india',
        'maldivas': 'maldives',
        'áƒ¨áƒ•áƒ”áƒ˜áƒªáƒáƒ áƒ˜áƒ': 'switzerland',
        'à·à·Š à¶»à·“ à¶½à¶‚à¶šà·à·€': 'sri lanka',
        'roemenie': 'romania',
        'russian federation': 'russia',
        'jordÃ¡nsko': 'jordan',
        'à¦­à§à¦Ÿà¦¾à¦¨': 'bhutan',
        'à¦­à¦¾à¦°à¦¤': 'india',
        'à¦¨à§‡à¦ªà¦¾à¦²': 'nepal',
        'à¦®à¦¾à¦°à§à¦•à¦¿à¦¨ à¦¯à§à¦•à§à¦¤à¦°à¦¾à¦·à§à¦Ÿà§à¦°': 'united states',
        'mw': 'malawi',
        'y deyrnas unedig': 'united kingdom',
        'ck': 'cook islands',
        'Ğ¼Ğ¾Ğ½Ğ³Ğ¾Ğ»Ğ¸Ñ': 'mongolia',
        'territorios palestinos': 'palestine',
        'giappone': 'japan',
        'à¸›à¸£à¸°à¹€à¸—à¸¨à¸‹à¸²à¸­à¸¸à¸”à¸µà¸­à¸²à¸£à¸°à¹€à¸šà¸µà¸¢': 'saudi arabia',
        'Ã©thiopie': 'ethiopia',
        'ÑÑÑ‚Ğ¾Ğ½Ğ¸Ñ': 'estonia',
        'Ğ¿Ğ¾Ğ»ÑŒÑˆĞ°': 'poland',
        'kÄ±brÄ±s cumhuriyeti': 'cyprus',
        'vc': 'saint vincent and the grenadines',
        'ireland & uk': 'united kingdom',
        'yhdistyneet arabiemiirikunnat': 'united arab emirates',
        'chint': 'unknown',
        'Ğ¼Ğ°Ğ»Ğ°Ğ¹Ğ·Ğ¸Ñ': 'malaysia',
        'egipt': 'egypt',
        'malÃ¡sia': 'malaysia',
        'u.s. minor outlying islands': 'united states',
        'leedu': 'lithuania',
        'gruusia': 'georgia',
        'rÃ©publique serbe de bosnie': 'serbia',
        'ÑĞ¿Ğ¾Ğ½Ğ¸Ñ': 'japan',
        'romani': 'romania',
        'afganistÃ¡n': 'afghanistan',
        'the-bahamas': 'bahamas',
        'filippinene': 'philippines',
        'Ã´sterreich': 'austria',
        'spojenÃ© krÃ¡Ä¾ovstvo': 'united kingdom',
        'west africa': 'west africa',
        'Ø§Ù„Ø£Ø±Ø§Ø¶ÙŠ Ø§Ù„ÙÙ„Ø³Ø·ÙŠÙ†ÙŠØ©': 'palestine',
        'Î½ÏŒÏ„Î¹Î± Î±Ï†ÏÎ¹ÎºÎ®': 'south africa',
        'tanzanie': 'tanzania',
        'à¸›à¸£à¸°à¹€à¸—à¸¨à¸¡à¸²à¹€à¸¥à¹€à¸‹à¸µà¸¢': 'malaysia',
        'jordaniÃ«': 'jordan',
        'vatican': 'vatican city',
        'sb': 'solomon islands',
        'sz': 'eswatini',
        'armeniÃ«': 'armenia',
        'territori palestinesi': 'palestine',
        'à¸›à¸£à¸°à¹€à¸—à¸¨à¸Ÿà¸´à¸¥à¸´à¸›à¸›à¸´à¸™à¸ªà¹Œ': 'philippines',
        'bg::bulgaria': 'bulgaria',
        'lÃ¤ti': 'latvia',
        'letland': 'latvia',
        'Ğ²ĞµĞ»Ğ¸ĞºĞ° Ğ±Ñ€Ğ¸Ñ‚Ğ°Ğ½Ñ–Ñ': 'ukraine',
        'Ñ‚ÑƒĞ½Ğ¸Ñ': 'tunisia',
        'bosniÃ« en herzegovina': 'bosnia and herzegovina',
        'central america': 'central america',
        'france ğŸ‡«ğŸ‡·': 'france',
        'urugwaj': 'uruguay',
        'cocoa horizons': 'unknown',
        'arab saudi': 'saudi arabia',
        'british-indian-ocean-territory': 'british indian ocean territory',
        'ruanda': 'rwanda',
        'fÃ¤rÃ¶er': 'faroe islands',
        'ijsland': 'iceland',
        'fÃ¦rÃ¸erne': 'faroe islands',
        'belanda': 'netherlands',
        'korea selatan': 'south korea',
        'nouvelle caledonie': 'australia',
        'northern ireland': 'united kingdom',
        'wales': 'united kingdom',
        'antigua-and-barbuda': 'antigua and barbuda',
        'ouganda': 'uganda',
        'kroatija': 'croatia',
        'etiopÃ­a': 'ethiopia',
        'saint-kitts-and-nevis': 'saint kitts and nevis',
        'nouvelle-aquitaine': 'france',
        'virazeil': 'france',
        'quebec': 'canada',
        'the netherlands': 'netherlands',
        'japonia': 'japan',
        'word': 'unknown',
        'aus': 'australia',
        'Ğ±ĞµĞ»Ğ°Ñ€ÑƒÑÑŒ': 'belarus',
        'made in the u k (ni)': 'united kingdom',
        'wa usa': 'united states',
        'baden': 'germany',
        'ouzbÃ©kistan': 'uzbekistan',
        'dr congo': 'democratic republic of the congo',
        'ariÃ¨ge': 'france',
        'imported by mccormick canada': 'canada',
        'on canada n6a 4z2': 'canada',
        'vancouver canada': 'canada',
        'vancouver bc canada': 'canada',
        'product of usa. packed in canada. imported by: strong international trading inc. richmond bc | www.siti.ca': 'canada',
        'rakÃºsko': 'austria',
        'norwa': 'norway',
        'é©¬æ¥è¥¿äºš': 'malaysia',
        'natural calm canada 5 idleswift dr. thornhill on l4j 1k6': 'canada',
        'ãƒãƒ€ã‚¬ã‚¹ã‚«ãƒ«': 'madagascar',
        'santo domingo': 'dominican republic',
        'hoa ká»³': 'united states',
        'svalbard et jan mayen': 'norway',
        'europa': 'europe',
        'corsica': 'france',
        'Ø§Ù„Ø¯Ù…Ø§Ù…': 'damam',
        'dubai': 'united arab emirates',
        'asia': 'asia',
        'brasill': 'brazil',
        'sicile': 'sicily',
        'surrey bc canada': 'canada',
        'italien': 'italy',
        'germany': 'germany',
        'france': 'france',
        'united states': 'united states',
        'irlande': 'ireland',
        'united kingdom': 'united kingdom',
        'Ã©tats-unis': 'united states',
        'canada': 'canada',
        'suisse': 'switzerland',
        'schweiz': 'switzerland',
        'spain': 'spain',
        'deutschland': 'germany',
        'slovenia': 'slovenia',
        'frankreich': 'france',
        'netherlands': 'netherlands',
        'switzerland': 'switzerland',
        'de': 'germany',
        'italy': 'italy',
        'romania': 'romania',
        'espaÃ±a': 'spain',
        'australia': 'australia',
        'world': 'world',
        'guadeloupe': 'reunion',
        'repÃºblica dominicana': 'dominican republic',
        'estados unidos': 'united states',
        'nederland': 'netherlands',
        'bolivia': 'bolivia',
        'mÃ©xico': 'mexico',
        'new zealand': 'new zealand',
        'sweden': 'sweden',
        'alemania': 'germany',
        'italia': 'italy',
        'antarctic': 'antarctica',
        'royaume-uni': 'united kingdom',
        'belgique': 'belgium',
        'pays-bas': 'netherlands',
        'suÃ¨de': 'sweden',
        'denemark': 'denmark',
        'norvÃ¨ge': 'norway',
        'espagne': 'spain',
        'pologne': 'poland',
        'none': np.nan,
        'inde': 'india',
        'autriche': 'austria',
        'espagne': 'spain',
        'united-kingdom': 'united kingdom',
        'hongrie': 'hungary',
        'rÃ©publique tchÃ¨que': 'czech republic',
        'france': 'france',
        'united-states': 'united states',
        'rÃ©publique tchÃ¨que': 'czech republic',
        'united-kingdom': 'united kingdom',
        'thailande': 'thailand',
        'Ã©tats-unis': 'united states',
        'egypte': 'egypt',
        'Ã©tats-unis': 'united states',
        'territoires palestiniens': 'palestine',
        'irlande': 'ireland',
        'Ã©tats-unis': 'united states',
        'japon': 'japan',
        'canada': 'canada',
        'rÃ©union': 'france',
        'monde': 'world',
        'france': 'france',
        'croatie': 'croatia',
        'irlande': 'ireland',
        'allemagne': 'germany',
        'Ã©tats-unis': 'united states',
        'suisse': 'switzerland',
        'taiwan': 'taiwan',
        'belgique': 'belgium',
        'luxembourg': 'luxembourg',
        'argentine': 'argentina',
        'maroc': 'morocco',
        'brÃ©sil': 'brazil',
        'belgique': 'belgium',
        'allemagne': 'germany',
        'france': 'france',
        'guatemala': 'guatemala',
        'australie': 'australia',
        'mexique': 'mexico',
        'arabie saoudite': 'saudi arabia',
        'arabie saoudite': 'saudi arabia',
        'Ã©mirats arabes unis': 'united arab emirates',
        'irak': 'iraq',
        'koweÃ¯t': 'kuwait',
        'Ã©mirats arabes unis': 'united arab emirates',
        'roumanie': 'romania',
        'costa rica': 'costa rica',
        'moldavie': 'moldova',
        'martinique': 'france',
        'new caledonia': 'australia',
        'singapore': 'singapore',
        'sverige': 'sweden',
        'usa': 'united states',
        'polynÃ©sie franÃ§aise': 'french polynesia',
        'french polynesia': 'french polynesia',
        'at': 'austria',
        'suiza': 'switzerland',
        'mexique': 'mexico',
        'ch': 'switzerland',
        'panamÃ¡': 'panama',
        'nouvelle-calÃ©donie': 'france',
        'panama': 'panama',
        'brazil': 'brazil',
        'australien': 'australia',
        'kanada': 'canada',
        'russia': 'russia',
        'vereinigtes kÃ¶nigreich': 'united kingdom',
        'paÃ­ses bajos': 'netherlands',
        'norway': 'norway',
        'reino unido': 'united kingdom',
        'monde': 'world',
        'yhdysvallat': 'united states',
        'suomi': 'finland',
        'made in canada from domestic and imported ingredients.': 'canada',
        'regno unito': 'united kingdom',
        'finland': 'finland',
        'à¸›à¸£à¸°à¹€à¸—à¸¨à¸à¸£à¸±à¹ˆà¸‡à¹€à¸¨à¸ª': 'france',
        'à¸ªà¸«à¸£à¸²à¸Šà¸­à¸²à¸“à¸²à¸ˆà¸±à¸à¸£': 'united kingdom',
        'æ³•å›½': 'france',
        'é¦™æ¸¯': 'hong kong',
        'hong kong': 'hong kong',
        'maurice': 'mauritius',
        'à¸›à¸£à¸°à¹€à¸—à¸¨à¹„à¸—à¸¢ (thai)': 'thailand',
        'ä¸­åäººæ°‘å…±å’Œå›½': 'china',
        'liban': 'lebanon',
        'philippines': 'philippines',
        'niederlande': 'netherlands',
        'belgien': 'belgium',
        'belgio': 'belgium',
        'germania': 'germany',
        'belgia': 'belgium',
        'sveitsi': 'switzerland',
        'saksa': 'germany',
        'ranska': 'france',
        'espanja': 'spain',
        'yhdistynyt kuningaskunta': 'united kingdom',
        'spagna': 'spain',
        'malaysia': 'malaysia',
        'guyana': 'guyana',
        'hungary': 'hungary',
        'mundo': 'world',
        'canadÃ¡': 'canada',
        'barbados': 'barbados',
        'ä¸­è¯æ°‘åœ‹': 'taiwan',
        'mexiko': 'mexico',
        'saint kitts and nevis': 'saint kitts and nevis',
        'us': 'united states',
        'haÃ¯ti': 'haiti',
        'el salvador': 'el salvador',
        'china': 'china',
        'bahreÃ¯n': 'bahrain',
        'italie': 'italy',
        'serbia': 'serbia',
        'ãƒ•ãƒ©ãƒ³ã‚¹': 'france',
        'colombia': 'colombia',
        'rÃ©union': 'france',
        'lebanon': 'lebanon',
        'oman': 'oman',
        'corÃ©e du sud': 'south korea',
        'trinidad and tobago': 'trinidad and tobago',
        'sÃ©nÃ©gal': 'senegal',
        'Î³Î±Î»Î»Î¯Î±': 'france',
        'ÎµÎ»Î»Î¬Î´Î±': 'greece',
        'greece': 'greece',
        'niemcy': 'germany',
        'cuba': 'cuba',
        'portugal': 'portugal',
        'kuwait': 'kuwait',
        'Ã¶sterreich': 'austria',
        'franzÃ¶sisch-polynesien': 'french polynesia',
        'israÃ«l': 'israel',
        'israel': 'israel',
        'puerto rico': 'puerto rico',
        'the bahamas': 'bahamas',
        'en': 'united kingdom',
        'polen': 'poland',
        'schweden': 'sweden',
        'aruba': 'aruba',
        'polinesia francesa': 'french polynesia',
        'ç¾å›½': 'united states',
        'uk': 'united kingdom',
        'angola': 'angola',
        'bolivie': 'bolivia',
        'franÃ§a': 'france',
        'maroc': 'morocco',
        'ã‚¢ãƒ¡ãƒªã‚«åˆè¡†å›½': 'united states',
        'noruega': 'norway',
        'dominican republic': 'dominican republic',
        'wielka brytania': 'united kingdom',
        'guinÃ©e': 'united states',
        'jordan': 'jordan',
        'burkina faso': 'burkina faso',
        'it': 'italy',
        'vietnam': 'vietnam',
        'pakistan': 'pakistan',
        'Ø§Ù„Ø¹Ø±Ø§Ù‚': 'iraq',
        'Ñ€Ğ¾ÑÑĞ¸Ñ': 'russia',
        'Ñ„Ñ€Ğ°Ğ½Ñ†Ğ¸Ñ': 'france',
        'Ğ±ÑŠĞ»Ğ³Ğ°Ñ€Ğ¸Ñ': 'bulgaria',
        'algÃ©rie': 'algeria',
        'saint pierre and miquelon': 'saint pierre and miquelon',
        'ÙƒÙ†Ø¯Ø§': 'canada',
        'saint-pierre-et-miquelon': 'saint pierre and miquelon',
        'ascension island': 'ascension island',
        'cÃ´te d\'ivoire': 'ivory coast',
        'jan mayen': 'norway',
        'uruguay': 'uruguay',
        'lb': 'lebanon',
        'haiti': 'haiti',
        'åŠ æ‹¿å¤§': 'canada',
        'new-caledonia': 'france',
        'gb': 'united kingdom',
        'england': 'united kingdom',
        'svizzera': 'switzerland',
        'bÃ©lgica': 'belgium',
        'russland': 'russia',
        'mauritius': 'mauritius',
        'indonÃ©sie': 'indonesia',
        'armÃ©nie': 'armenia',
        'ç‘å£«': 'switzerland',
        'autriche': 'austria',
        'grecia': 'greece',
        'grÃ¨ce': 'greece',
        'india': 'india',
        'poland': 'poland',
        'curaÃ§ao': 'curaÃ§ao',
        'perancis': 'france',
        'indonesia': 'indonesia',
        'selandia baru': 'new zealand',
        'swiss': 'switzerland',
        'finnland': 'finland',
        'polska': 'poland',
        'sÃ¼dkorea': 'south korea',
        'south africa': 'south africa',
        'ecuador': 'ecuador',
        'chile': 'chile',
        'perÃº': 'peru',
        'honduras': 'honduras',
        'nicaragua': 'nicaragua',
        'turkey': 'turkey',
        'arabie saoudite': 'saudi arabia',
        'spojenÃ© stÃ¡ty americkÃ©': 'united states',
        'meksyk': 'mexico',
        'Ã©mirats arabes unis': 'united arab emirates',
        'croatia': 'croatia',
        'cambodia': 'cambodia',
        'neukaledonien': 'france',
        'republik china': 'china',
        'spojenÃ© krÃ¡lovstvÃ­': 'united kingdom',
        'guernsey': 'guernsey',
        'mauricio': 'mauritius',
        'singapour': 'singapore',
        'european union': 'europe',
        'jamaica': 'jamaica',
        'denmark': 'denmark',
        'luxemburg': 'luxembourg',
        'hawaii': 'united states',
        'german democratic republic': 'germany', 
        'corea del sur': 'south korea',
        'tunisie': 'tunisia',
        'soviet union': 'russia', 
        'algeria': 'algeria',
        'jordanie': 'jordan',
        'à¸›à¸£à¸°à¹€à¸—à¸¨à¸ªà¸§à¸´à¸•à¹€à¸‹à¸­à¸£à¹Œà¹à¸¥à¸™à¸”à¹Œ': 'switzerland',
        'fr  â‚¬': 'france', 
        'hongkong': 'hong kong',
        'verenigde staten van amerika': 'united states',
        'Î·Î½Ï‰Î¼Î­Î½Î¿ Î²Î±ÏƒÎ¯Î»ÎµÎ¹Î¿': 'united kingdom',
        'rÃ©publique dÃ©mocratique du congo': 'democratic republic of the congo',
        'tunÃ­sia': 'tunisia',
        'togo': 'togo',
        'qatar': 'qatar',
        'dinamarca': 'denmark',
        'guyane': 'french guiana',
        'union europÃ©enne': 'europe',
        'bulgaria': 'bulgaria',
        'zjednoczone krÃ³lestwo': 'united kingdom',
        'somalÃ­a': 'somalia',
        'uniÃ³n europea': 'europe',
        'lÃ­bano': 'lebanon',
        'belgiÃ«': 'belgium',
        'peru': 'peru',
        'luxemburgo': 'luxembourg',
        'zwitserland': 'switzerland',
        'jordanien': 'jordan',
        'ØªÙˆÙ†Ø³': 'tunisia',
        'rÃ©publique tchÃ¨que': 'czech republic',
        'romÃ¢nia': 'romania',
        'saint-pierre und miquelon': 'saint pierre and miquelon',
        'Ã©gypte': 'egypt',
        'monaco': 'monaco',
        'cyprus': 'cyprus',
        'Ø§Ù„Ø¬Ø²Ø§Ø¦Ø±': 'algeria',
        'vezuela': 'venezuela',
        'finlande': 'finland',
        'æ—¥æœ¬': 'japan',
        'afrique du sud': 'south africa',
        'cayman islands': 'cayman islands',
        'Ø§Ù„Ø¥Ù…Ø§Ø±Ø§Øª Ø§Ù„Ø¹Ø±Ø¨ÙŠØ© Ø§Ù„Ù…ØªØ­Ø¯Ø©': 'united arab emirates',
        'irlanda': 'ireland',
        'paraguay': 'paraguay',
        'denemarken': 'denmark',
        'italiÃ«': 'italy',
        'noorwegen': 'norway',
        'spanje': 'spain',
        'zweden': 'sweden',
        'Ù„Ø¨Ù†Ø§Ù†': 'lebanon',
        'ÙØ±Ù†Ø³Ø§': 'france',
        'cameroon': 'cameroon',
        'mongolia': 'mongolia',
        'irland': 'ireland',
        'myanmar': 'myanmar',
        'marruecos': 'morocco',
        'à¤­à¤¾à¤°à¤¤': 'india',
        'senegal': 'senegal',
        'tchad': 'chad',
        'suriname': 'suriname',
        'bulgarie': 'bulgaria',
        'albania': 'albania',
        'chili': 'chile',
        'norwegen': 'norway',
        'cameroun': 'cameroon',
        'virgin islands of the united states': 'united states',
        'japÃ³n': 'japan',
        'Ø§Ù„ÙˆÙ„Ø§ÙŠØ§Øª Ø§Ù„Ù…ØªØ­Ø¯Ø©': 'united states',
        'bangladesh': 'bangladesh',
        'australiÃ«': 'australia',
        'nieuw-zeeland': 'new zealand',
        'slowakije': 'slovakia',
        'dominica': 'dominica',
        'mÃ©xico': 'mexico',
        'suecia': 'sweden',
        'Ğ±ĞµĞ»ÑŒĞ³Ğ¸Ñ': 'belgium',
        'nigeria': 'nigeria',
        'maÄ‘arska': 'hungary',
        'italija': 'italy',
        'poljska': 'poland',
        'japon': 'japan',
        'à¦¬à¦¾à¦‚à¦²à¦¾à¦¦à§‡à¦¶': 'bangladesh',
        'wÅ‚ochy': 'italy',
        'hiszpania': 'spain',
        'szwajcaria': 'switzerland',
        'frankrike': 'france',
        'lotyÅ¡sko': 'latvia',
        'litva': 'lithuania',
        'polsko': 'poland',
        'djibouti': 'djibouti',
        'dÃ¤nemark': 'denmark',
        'tyskland': 'germany',
        'finlÃ¢ndia': 'finland',
        'espanha': 'spain',
        'suÃ©cia': 'sweden',
        'lithuania': 'lithuania',
        'suÃ­Ã§a': 'switzerland',
        'south korea': 'south korea',
        'Å¡vedska': 'sweden',
        'nÄ›mecko': 'germany',
        'islande': 'iceland',
        'grÃ©cia': 'greece',
        'itÃ¡lia': 'italy',
        'polÃ³nia': 'poland',
        'hongrie': 'hungary',
        'serbie': 'serbia',
        'ÑĞ¾ÑĞ· ÑĞ¾Ğ²ĞµÑ‚ÑĞºĞ¸Ñ… ÑĞ¾Ñ†Ğ¸Ğ°Ğ»Ğ¸ÑÑ‚Ğ¸Ñ‡ĞµÑĞºĞ¸Ñ… Ñ€ĞµÑĞ¿ÑƒĞ±Ğ»Ğ¸Ğº': 'ussr',
        'brÃ©sil': 'brazil',
        'ukraine': 'ukraine',
        'Ã­sland': 'iceland',
        'tÃ¼rkiye': 'turkey',
        'madagascar': 'madagascar',
        'macau': 'macau',
        'franÈ›a': 'france',
        'ÑƒĞºÑ€Ğ°Ñ—Ğ½Ğ°': 'ukraine',
        'latvia': 'latvia',
        'estonia': 'estonia',
        'Ğ³ĞµÑ€Ğ¼Ğ°Ğ½Ğ¸Ñ': 'germany',
        'ÑˆĞ²ĞµĞ¹Ñ†Ğ°Ñ€Ğ¸Ñ': 'switzerland',
        'duitsland': 'germany',
        'sÃ¼dafrika': 'south africa',
        'bulharsko': 'bulgaria',
        'czech-republic': 'czech republic',
        'nizozemsko': 'netherlands',
        'austrija': 'austria',
        'alemanha': 'germany',
        'Ã¡ustria': 'austria',
        'nÃ©morszag': 'hungary',
        'kroatien': 'croatia',
        'csehorszÃ¡g': 'czech republic',
        'lengyelorszÃ¡g': 'poland',
        'svÃ©dorszÃ¡g': 'sweden',
        'rumania': 'romania',
        'ungarn': 'hungary',
        'paÃ­ses baixos': 'netherlands',
        'Ğ°Ğ²ÑÑ‚Ñ€Ğ¸Ñ': 'austria',
        'Ñ„Ğ¸Ğ½Ğ»Ğ°Ğ½Ğ´Ğ¸Ñ': 'finland',
        'ÑˆĞ²ĞµÑ†Ğ¸Ñ': 'sweden',
        'bulgarien': 'bulgaria',
        'tschechien': 'czech republic',
        'slowakei': 'slovakia',
        'slowenien': 'slovenia',
        'lituania': 'lithuania',
        'Ğ¸ÑĞ¿Ğ°Ğ½Ğ¸Ñ': 'spain',
        'repÃºblica checa': 'czech republic',
        'marrocos': 'morocco',
        'Ğ¿Ğ¾Ğ»ÑˆĞ°': 'poland',
        'Ñ€ÑƒĞ¼ÑŠĞ½Ğ¸Ñ': 'romania',
        'ÑÑŠÑ€Ğ±Ğ¸Ñ': 'serbia',
        'Ñ…ÑŠÑ€Ğ²Ğ°Ñ‚Ğ¸Ñ': 'croatia',
        'ungheria': 'hungary',
        'storbritannien': 'united kingdom',
        'rumÃ¤nien': 'romania',
        'finlandia': 'finland',
        'polonia': 'poland',
        'Ğ¸Ñ‚Ğ°Ğ»Ğ¸Ñ': 'italy',
        'ÑƒĞºÑ€Ğ°Ğ¸Ğ½Ğ°': 'ukraine',
        'Ğ±ĞµĞ»Ğ³Ğ¸Ñ': 'belgium',
        'griechenland': 'greece',
        'alankomaat': 'netherlands',
        'olaszorszÃ¡g': 'hungary',
        'romÃ¡nia': 'romania',
        'danmark': 'denmark',
        'amerikai egyesÃ¼lt Ã¡llamok': 'united states',
        'ruotsi': 'finland',
        'tanska': 'denmark',
        'paesi bassi': 'netherlands',
        'france switzerland germany': 'france',
        'nederlÃ¤nderna': 'sweden',
        'ÑƒĞ½Ğ³Ğ°Ñ€Ğ¸Ñ': 'hungary',
        'nizozemska': 'netherlands',
        'Å¡panjolska': 'spain',
        'ujedinjeno kraljevstvo': 'united kingdom',
        'espanya': 'spain',
        'regne unit': 'united kingdom',
        'norwegia': 'norway',
        'hongarije': 'hungary',
        'ÄeÅ¡ka': 'czech republic',
        'slovaÄka': 'slovakia',
        'lu': 'luxembourg',
        'repÃºblica da irlanda': 'ireland',
        'Å¡vÃ©dsko': 'sweden',
        'rakousko': 'austria',
        'serbien': 'serbia',
        'czechy': 'czech republic',
        'litwa': 'lithuania',
        'holandia': 'netherlands',
        'sÅ‚owacja': 'slovakia',
        'itÃ¡lie': 'italy',
        'prancÅ«zija': 'france',
        'vokietija': 'germany',
        'Å¡veicarija': 'switzerland',
        'lietuva': 'lithuania',
        'slovensko': 'slovakia',
        'croÃ¡cia': 'croatia',
        'sÃ©rvia': 'serbia',
        'eslovÃ¡quia': 'slovakia',
        'eslovÃ©nia': 'slovenia',
        'birleÅŸik krallÄ±k': 'united kingdom',
        'slovakia': 'slovakia',
        'republik zypern': 'cyprus',
        'buÅ‚garia': 'bulgaria',
        'eslovenia': 'slovenia',
        'bulgÃ¡ria': 'bulgaria',
        'hungria': 'hungary',
        'romÃ©nia': 'romania',
        'puola': 'poland',
        'slovenija': 'slovenia',
        'srbija': 'serbia',
        'bugarska': 'bulgaria',
        'svezia': 'sweden',
        'nouvelle-zÃ©lande': 'new zealand',
        'gÃ¶rÃ¶gorszÃ¡g': 'greece',
        'belgicko': 'belgium',
        'francÃºzsko': 'france',
        'nemecko': 'germany',
        'rusko': 'russia',
        'croatie': 'croatia',
        'croacia': 'croatia',
        'hungrÃ­a': 'hungary',
        'Å¡vÃ½carsko': 'switzerland',
        'dania': 'denmark',
        'grecja': 'greece',
        'szwecja': 'sweden',
        'albanien': 'albania',
        'estonija': 'estonia',
        'latvija': 'latvia',
        'Å¡vajÄiarsko': 'switzerland',
        'oostenrijk': 'austria',
        'united kingdom & ireland': 'united kingdom',
        'eslovaquia': 'slovakia',
        'sÅ‚owenia': 'slovenia',
        'francija': 'france',
        'moldova': 'moldova',
        'malta': 'malta',
        'ÑÑŠĞµĞ´Ğ¸Ğ½ĞµĞ½Ğ¸ Ğ°Ğ¼ĞµÑ€Ğ¸ĞºĞ°Ğ½ÑĞºĞ¸ Ñ‰Ğ°Ñ‚Ğ¸': 'united states',
        'Ğ¾Ğ±ĞµĞ´Ğ¸Ğ½ĞµĞ½Ğ¾ ĞºÑ€Ğ°Ğ»ÑÑ‚Ğ²Ğ¾ Ğ²ĞµĞ»Ğ¸ĞºĞ¾Ğ±Ñ€Ğ¸Ñ‚Ğ°Ğ½Ğ¸Ñ Ğ¸ ÑĞµĞ²ĞµÑ€Ğ½Ğ° Ğ¸Ñ€Ğ»Ğ°Ğ½Ğ´Ğ¸Ñ': 'united kingdom',
        'slovÃ©nie': 'slovenia',
        'rumunsko': 'romania',
        'tsjechiÃ«': 'czech republic',
        'slovacchia': 'slovakia',
        'slovaquie': 'slovakia',
        'Å‚otwa': 'latvia',
        'lituÃ¢nia': 'lithuania',
        'maÄarsko': 'hungary',
        'Å¡panÄ›lsko': 'spain',
        'gabon': 'gabon',
        'Å¡panielsko': 'spain',
        'belgija': 'belgium',
        'grÄka': 'greece',
        'ÑÑ€Ğ±Ğ¸Ñ˜Ğ°': 'serbia',
        'ie': 'ireland',
        'frankrig': 'denmark',
        'rumunjska': 'romania',
        'portogallo': 'portugal',
        'Ø¥ÙŠØ·Ø§Ù„ÙŠØ§': 'italy',
        'Ñ‡ĞµÑ…Ğ¸Ñ': 'czech republic',
        'republika srpska': 'bosnia and herzegovina',
        'cn': 'china',
        'chine': 'china',
        'austrÃ¡lia': 'australia',
        'iran': 'iran',
        'algerien': 'algeria',
        'nederlÃ¢n': 'netherlands',
        'pÃ©rou': 'peru',
        'Å¡vica': 'switzerland',
        'ã‚¹ãƒšã‚¤ãƒ³': 'spain',
        'kÃ­na': 'china',
        'ausztria': 'austria',
        'bÃ¨lgica': 'belgium',
        'belgie': 'belgium',
        'austrÃ¡lie': 'australia',
        'ëŒ€í•œë¯¼êµ­': 'south korea',
        'french guiana': 'french guiana',
        're': 'reunion',
        'af': 'afghanistan',
        'argelia': 'algeria',
        'argentine': 'argentina',
        'colombie': 'colombia',
        'russie': 'russia',
        'mali': 'mali',
        'martinica': 'martinique',
        'reuniÃ³n': 'reunion',
        'reunion': 'reunion',
        'jp': 'japan',
        'guadalupe': 'reunion',
        'cote-d-ivoire': 'ivory coast',
        'ĞºĞ°Ğ·Ğ°Ñ…ÑÑ‚Ğ°Ğ½': 'kazakhstan',
        'afghanistan': 'afghanistan',
        'saint-martin': 'saint martin',
        'marocco': 'morocco',
        'biÃ©lorussie': 'belarus',
        'mq': 'martinique',
        'kazakhstan': 'kazakhstan',
        'marokko': 'morocco',
        'tunisia': 'tunisia',
        'rÃ©publique du congo': 'republic of the congo',
        'maroko': 'morocco',
        'mayotte': 'mayotte',
        'estonie': 'estonia',
        'french-polynesia': 'french polynesia',
        'thaÃ¯lande': 'thailand',
        'Ğ°Ğ²ÑÑ‚Ñ€Ğ°Ğ»Ğ¸Ñ': 'australia',
        'Ğ¼Ğ°Ñ€Ğ¾ĞºĞ¾': 'morocco',
        'Ğ½Ğ¾Ğ²Ğ° Ğ·ĞµĞ»Ğ°Ğ½Ğ´Ğ¸Ñ': 'new zealand',
        'estÃ³nia': 'estonia',
        'andorra': 'andorra',
        'nova zelÃ¢ndia': 'new zealand',
        'rÃºssia': 'russia',
        'tailandia': 'thailand',
        'à¸›à¸£à¸°à¹€à¸—à¸¨à¸­à¸­à¸ªà¹€à¸•à¸£à¹€à¸¥à¸µà¸¢': 'australia',
        'à¸›à¸£à¸°à¹€à¸—à¸¨à¸­à¸­à¸ªà¹€à¸•à¸£à¸µà¸¢': 'austria',
        'à¸›à¸£à¸°à¹€à¸—à¸¨à¹€à¸šà¸¥à¹€à¸¢à¸µà¸¢à¸¡': 'belgium',
        'à¸›à¸£à¸°à¹€à¸—à¸¨à¹€à¸¢à¸­à¸£à¸¡à¸™à¸µ': 'germany',
        'à¸›à¸£à¸°à¹€à¸—à¸¨à¸­à¸´à¸•à¸²à¸¥à¸µ': 'italy',
        'à¸›à¸£à¸°à¹€à¸—à¸¨à¹€à¸¥à¸šà¸²à¸™à¸­à¸™': 'lebanon',
        'à¸›à¸£à¸°à¹€à¸—à¸¨à¹‚à¸¡à¸£à¹‡à¸­à¸à¹‚à¸': 'morocco',
        'à¸›à¸£à¸°à¹€à¸—à¸¨à¹‚à¸£à¸¡à¸²à¹€à¸™à¸µà¸¢': 'romania',
        'à¸›à¸£à¸°à¹€à¸—à¸¨à¸ªà¹€à¸›à¸™': 'spain',
        'Ã¥land islands': 'finland',
        'bielorussia': 'belarus',
        'frakland': 'france',
        '#value!': np.nan,
        'nl': 'netherlands',
        'koeweit': 'kuwait',
        'dom tom': 'france',
        'Ğ°Ğ»Ğ¶Ğ¸Ñ€': 'algeria',
        'reuniÃ£o': 'reunion',
        'dom-tom': 'france',
        'à¸›à¸£à¸°à¹€à¸—à¸¨à¸£à¸±à¸ªà¹€à¸‹à¸µà¸¢': 'russia',
        'à¸ªà¸«à¸£à¸±à¸à¸­à¹€à¸¡à¸£à¸´à¸à¸²': 'united states',
        'sg': 'singapore',
        'svÃ¡jc': 'switzerland',
        'Ğ»Ğ°Ñ‚Ğ²Ğ¸Ñ': 'latvia',
        'Ğ³Ñ€ÑƒĞ·Ğ¸Ñ': 'georgia',
        'nueva caledonia': 'australia',
        'ru': 'russia',
        'seychelles': 'seychelles',
        'costa de marfil': 'ivory coast',
        'sjedinjene ameriÄke drÅ¾ave': 'united states',
        'danska': 'denmark',
        'rusija': 'russia',
        'burkina-faso': 'burkina faso',
        'norge': 'norway',
        'li': 'liechtenstein',
        'Ñ€ĞµÑĞ½Ğ¸Ğ¾Ğ½': 'reunion',
        'lussemburgo': 'luxembourg',
        'vanuatu': 'vanuatu',
        'roemeniÃ«': 'romania',
        'rumunia': 'romania',
        'ma': 'morocco',
        'viÃªt nam': 'vietnam',
        'albanie': 'albania',
        'argÃ©lia': 'algeria',
        'pas': np.nan,
        'kh': 'cambodia',
        'Ø§Ù„Ø£Ø±Ø¯Ù†': 'jordan',
        'mf': 'saint martin',
        'french-guiana': 'french guiana',
        'mongolie': 'mongolia',
        'gp': 'reunion',
        'franzÃ¶sisch-guayana': 'french guiana',
        'nuova caledonia': 'australia',
        'france la rÃ©union': 'reunion',
        'ÑĞµĞ½ĞµĞ³Ğ°Ğ»': 'senegal',
        'cambodge': 'cambodia',
        'jersey': 'jersey',
        'france ğŸ‡¨ğŸ‡µğŸ‡«ğŸ‡·': 'france',
        'gf': 'french guiana',
        'angleterre': 'england',
        'andorre': 'andorra',
        'irak': 'iraq',
        'emirats arabes unis': 'united arab emirates',
        'democratic republic of the congo': 'democratic republic of the congo',
        'bulgarije': 'bulgaria',
        'griekenland': 'greece',
        'rÃ©publique dominicaine': 'dominican republic',
        'spania': 'spain',
        'nc': 'australia',
        'ucrania': 'ukraine',
        'welt': 'world',
        'liechtenstein': 'liechtenstein',
        'estland': 'estonia',
        'hollande': 'netherlands',
        'turquie': 'turkey',
        'mauritanie': 'mauritania',
        'iceland': 'iceland',
        'ÑĞ¸Ğ½Ğ³Ğ°Ğ¿ÑƒÑ€': 'singapore',
        'szerbia': 'serbia',
        'srbsko': 'serbia',
        'georgia': 'georgia',
        'ungaria': 'hungary',
        'avstrija': 'austria',
        'hrvaÅ¡ka': 'croatia',
        'republika srbska': 'bosnia and herzegovina',
        'bosna in hercegovina': 'bosnia and herzegovina',
        'Ärna gora': 'montenegro',
        'bosna i hercegovina': 'bosnia and herzegovina',
        'sjeverna makedonija': 'north macedonia',
        'albanija': 'albania',
        'saudijska arabija': 'saudi arabia',
        'republic of macedonia': 'north macedonia',
        'bosnia and herzegovina': 'bosnia and herzegovina',
        'montenegro': 'montenegro',
        'nordmazedonien': 'north macedonia',
        'szlovÃ¡kia': 'slovakia',
        'Ñ„Ñ€Ğ°Ğ½Ñ†ÑƒÑĞºĞ°': 'france',
        'Ğ±Ğ¾ÑĞ½Ğ° Ğ¸ Ñ…ĞµÑ€Ñ†ĞµĞ³Ğ¾Ğ²Ğ¸Ğ½Ğ°': 'bosnia and herzegovina',
        'crna gora': 'montenegro',
        'Ñ†Ñ€Ğ½Ğ° Ğ³Ğ¾Ñ€Ğ°': 'montenegro',
        'nya kaledonien': 'australia',
        'singapur': 'singapore',
        'Ñ€ÑƒÑĞ¸Ñ˜Ğ°': 'russia',
        'prantsusmaa': 'france',
        'hispaania': 'spain',
        'eesti': 'estonia',
        'saksamaa': 'germany',
        'dÃ¡nsko': 'denmark',
        'chiÅ„ska republika ludowa': 'china',
        'Ğ½Ğ¸Ğ´ĞµÑ€Ğ»Ğ°Ğ½Ğ´Ğ¸Ñ': 'netherlands',
        'estija': 'estonia',
        'suomija': 'finland',
        'rumunija': 'romania',
        'Å¡vedija': 'sweden',
        'jungtinÄ— karalystÄ—': 'united kingdom',
        'chipre': 'cyprus',
        'ÎºÏÏ€ÏÎ¿Ï‚': 'cyprus',
        'Ğ±ĞµĞ»Ğ¾Ñ€ÑƒÑÑĞ¸Ñ': 'belarus',
        'bÄ›lorusko': 'belarus',
        'argentinien': 'argentina',
        'saudi-arabien': 'saudi arabia',
        'ã‚¤ã‚®ãƒªã‚¹': 'united kingdom',
        'bahrain': 'bahrain',
        'deutsche demokratische republik': 'east germany',
        'Ğ½ĞµĞ¼Ğ°Ñ‡ĞºĞ°': 'germany',
        'Ğ½Ñ–Ğ¼ĞµÑ‡Ñ‡Ğ¸Ğ½Ğ°': 'germany',
        'Ğ¿Ğ¾Ğ»ÑŒÑ‰Ğ°': 'poland',
        'wÄ™gry': 'hungary',
        'north macedonia': 'north macedonia',
        'swaziland': 'eswatini',
        'elveÈ›ia': 'switzerland',
        'macÃ©doine du nord': 'north macedonia',
        'east germany': 'germany',
        'chypre': 'cyprus',
        'Ø¨Ù„Ø¬ÙŠÙƒØ§': 'belgium',
        'Ø£Ù„Ù…Ø§Ù†ÙŠØ§': 'germany',
        'island': 'iceland',
        'alemanya': 'germany',
        'Ù„ÙŠØ¨ÙŠØ§': 'libya',
        'Ñ€Ğ¾ÑÑ–Ñ': 'russia',
        'unkari': 'hungary',
        'lucembursko': 'luxembourg',
        'chorvatsko': 'croatia',
        'rusland': 'russia',
        'no': 'norway',
        'danimarca': 'denmark',
        'kosovo': 'kosovo',
        'bolivien': 'bolivia',
        'deut': 'germany',
        'rusia': 'russia',
        'belarus': 'belarus',
        'kyrgyzstan': 'kyrgyzstan',
        'tajikistan': 'tajikistan',
        'uzbekistan': 'uzbekistan',
        'armenia': 'armenia',
        'Ğ°Ğ·ĞµÑ€Ğ±Ğ°Ğ¹Ğ´Ğ¶Ğ°Ğ½': 'azerbaijan',
        'azerbaijan': 'azerbaijan',
        'australija': 'australia',
        'lettonie': 'latvia',
        'lettland': 'latvia',
        'fransa': 'france',
        'aserbaidschan': 'azerbaijan',
        'lituanie': 'lithuania',
        'jungtinÄ—s amerikos valstijos': 'united states',
        'sri lanka': 'sri lanka',
        'à¹€à¸‚à¸•à¸šà¸£à¸´à¸«à¸²à¸£à¸à¸´à¹€à¸¨à¸©à¸®à¹ˆà¸­à¸‡à¸à¸‡': 'hong kong',
        'à¸™à¸´à¸§à¹à¸„à¸¥à¸´à¹‚à¸”à¹€à¸™à¸µà¸¢': 'australia',
        'neuseeland': 'new zealand',
        'Ñ‚Ğ°Ğ´Ğ¶Ğ¸ĞºĞ¸ÑÑ‚Ğ°Ğ½': 'tajikistan',
        'Ñ„Ñ€Ğ°Ğ½Ñ†Ñ–Ñ': 'france',
        'Ğ»Ğ°Ñ‚Ğ²Ñ–Ñ': 'latvia',
        'ucrÃ¢nia': 'ukraine',
        'ucraina': 'ukraine',
        'republica moldova': 'moldova',
        'moldavie': 'moldova',
        'gÃ©orgie': 'georgia',
        'áƒ¡áƒáƒ¥áƒáƒ áƒ—áƒ•áƒ”áƒšáƒ': 'georgia',
        'hong-kong': 'hong kong',
        'Ù‚Ø·Ø±': 'qatar',
        'ä¸­è¯æ°‘å›½': 'taiwan',
        'æ¾³é—¨': 'macau',
        'mozambique': 'mozambique',
        'arabia saudita': 'saudi arabia',
        '×™×©×¨××œ': 'israel',
        'irlandia': 'ireland',
        'zjednoczone emiraty arabskie': 'united arab emirates',
        'norja': 'norway',
        'Ø§Ù„Ù…Ù…Ù„ÙƒØ© Ø§Ù„Ù…ØªØ­Ø¯Ø©': 'united kingdom',
        'Ø§Ù„Ù…ØºØ±Ø¨': 'morocco',
        'republic of ireland': 'ireland',
        'europÃ¤ische union': 'europe',
        'franciaorszÃ¡g': 'france', 
        'spanien': 'spain', 
        'Äesko': 'czech republic', 
        'francie': 'france', 
        'nagy-britannia': 'united kingdom', 
        'magyarorszÃ¡g': 'hungary', 
        'frankrijk': 'france', 
        'verenigd koninkrijk': 'united kingdom', 
        'vereinigte staaten von amerika': 'united states', 
        'la rÃ©union': 'reunion', 
        'svijet': 'world', 
        'francuska': 'france', 
        'hrvatska': 'croatia', 
        'irska': 'ireland', 
        'njemaÄka': 'europe', 
        'sjedinjene-ameriÄke-drÅ¾ave': 'united states', 
        'Å¡vicarska': 'switzerland', 
        "stati uniti d'america": 'united states', 
        'saint kitts and nevis': 'united states', 
        'el salvador': 'salvador', 
        'emiratos Ã¡rabes unidos': 'united arab emirates', 
        'francja': 'france', 
        'stany zjednoczone': 'united states', 
        'brasil': 'brazil', 
        'guernsey': 'united kingdom', 
        'french guiana': 'united states', 
        'saint pierre and miquelon': 'united states', 
        'trinidad and tobago': 'united states',
        'mÅ•xico': 'mexico', 
        'latvia': 'lithuania', 
        'ussr': 'russia', 
        'macau': 'china', 
        'nÃ©metorszÃ¡g': 'germany', 
        'litauen': 'lithuania', 
        'saint martin': 'reunion', 
        'guadeloupe': 'reunion', 
        'republic of the congo': 'democratic republic of the congo', 
        'mayotte': 'reunion', 
        'new caledonia': 'australia', 
        'seychelles': 'reunion', 
        'liechtenstein': 'switzerland',
        'france - la rÃ©union': 'reunion', 
        'jersey': 'united kingdom', 
        'england': 'united kingdom', 
        'madagascar': 'reunion', 
        'east germany': 'germany', 
        'bangladesh': 'india', 
        'francia  espaÃ±a': 'france', 
        'france  spain': 'france', 
        'palestinian territories': 'palestine', 
        'europÃ¤ische union': 'europe', 
        'soviet union': 'russia', 
        'republic of ireland': 'ireland', 
        'middle east:': 'romania',
        'saint': 'united states', 
        'papua new guinea': 'united states',
        'ĞºĞ°Ğ½Ğ°Ğ´Ğ°': 'canada', 
        'south america': 'peru',
        'zimbabwe': 'reunion', 
        'america': 'united states',
        'product of usa. packed in canada.  imported by: strong international trading inc. richmond bc | www.siti.ca': 'united states', 
        'natural calm canada 5 idleswift dr.  thornhill on  l4j 1k6': 'canada', 
    }
    df['countries'] = df['countries'].replace(values_to_replace, np.nan)
    df['countries'] = df['countries'].apply(lambda x: x.split(', ') if isinstance(x, str) else ([] if pd.isna(x) else x))
    df['countries'] = df['countries'].apply(lambda x: ', '.join(x) if isinstance(x, list) else x)
    df['countries'] = df['countries'].str.lower()
    df['countries'] = df['countries'].apply(clean_abrev)
    df['countries'] = df['countries'].replace(country_mapping)
    country_counts = df['countries'].value_counts(normalize=True)
    rare_countries = country_counts[country_counts < 0.001].index
    def replace_rare_countries(countries):
        if isinstance(countries, str):
            countries_list = [c.strip() for c in countries.split(',')]
            updated_countries = [c if c not in rare_countries else np.nan for c in countries_list]
            return ', '.join(filter(lambda x: x is not np.nan, updated_countries)) if updated_countries else np.nan
        return np.nan
    df['countries'] = df['countries'].apply(replace_rare_countries)
    df['countries'] = df['countries'].replace(values_to_replace, np.nan)
    return df

def labels_processing(df, values_to_replace): 
    df['labels_temp'] = df['labels_temp'].replace(values_to_replace, np.nan)
    df['labels_temp'] = df['labels_temp'].apply(
    lambda x: x if isinstance(x, list) 
    else ([] if pd.isna(x) or x is None else x.split(', ')))
    df['labels_temp'] = df['labels_temp'].apply(lambda x: x if isinstance(x, list) else ([] if x is np.nan else x.split(', ')))
    def extract_en_labels(labels_list):
        if isinstance(labels_list, str):
            labels_list = labels_list.split(', ')
        return [ingredient.split(':', 1)[-1] for ingredient in labels_list if ingredient.startswith('en:')]
    df['labels'] = df['labels_temp'].apply(extract_en_labels)
    df['labels'] = df['labels'].apply(lambda x: ', '.join(x) if x else np.nan)
    df.drop(columns=['labels_temp'], inplace=True)
    def count_commas_plus_one(value):
        if pd.isna(value):  
            return 0
        return value.count(',') +1
    df['labels_note'] = df['labels'].apply(count_commas_plus_one)
    df.drop(columns=['labels'], inplace=True)
    # ramÃ¨ne toutes les notes > 9 Ã  9
    df['labels_note'] = df['labels_note'].apply(lambda x: min(x, 9) if pd.notna(x) else x)
    df['labels_note'] = df['labels_note'].apply(lambda x: (x - 0) / (9 - 0) if pd.notna(x) else x)
    return df

def ecoscore_tags_processing(df, values_to_replace): 
    df['ecoscore_tags'] = df['ecoscore_tags'].replace(values_to_replace, np.nan)
    ecoscore_grad_map = {'a': 0, 'b': 1, 'c': 2, 'd': 3, 'e': 4}
    df['ecoscore_tags'] = df['ecoscore_tags'].apply(lambda x: ', '.join(x) if isinstance(x, list) else x)
    df['ecoscore_tags'] = df['ecoscore_tags'].replace(ecoscore_grad_map, regex=True)
    df['ecoscore_tags'] = pd.to_numeric(df['ecoscore_tags'], errors='coerce')
    scaler = MinMaxScaler()
    df['ecoscore_tags'] = scaler.fit_transform(df[['ecoscore_tags']])
    return df

def ecoscore_score_processing(df, values_to_replace): 
    df['ecoscore_score'] = df['ecoscore_score'].replace(values_to_replace, np.nan) 
    # remplace toutes les valeurs < 0 par 0, et toutes celles > 100 par 100
    df['ecoscore_score'] = df['ecoscore_score'].apply(lambda x: max(0, min(x, 100)) if not pd.isna(x) else x)
    return df

def groups_processing(df, values_to_replace):
    df['groups'] = df['groups'].replace(values_to_replace, np.nan) 
    df['groups'] = df['groups'].astype(str)
    df['groups'] = df['groups'].str.lower() 
    ecoscore_grad_map = {'sugary snacks': 0,
                        'fat and sauces': 1,
                        'composite foods': 2,
                            'fruits and vegetables': 3,
                            'milk and dairy products': 4, 
                            'cereals and potatoes': 5, 
                            'fish meat eggs': 6, 
                            'beverages': 7, 
                            'alcoholic beverages': 8, 
                            'salty snacks': 9, 
                            'sugary-snacks': 10}
    df['groups'] = df['groups'].apply(lambda x: ', '.join(x) if isinstance(x, list) else x)
    df['groups'] = df['groups'].replace(ecoscore_grad_map, regex=True)
    df['groups'] = pd.to_numeric(df['groups'], errors='coerce')
    scaler = MinMaxScaler()
    df['groups'] = scaler.fit_transform(df[['groups']])
    df['groups'] = df['groups'].replace(values_to_replace, np.nan) 
    return df

def name_processing(df, values_to_replace): 
    df['name'] = df['name'].replace(values_to_replace, np.nan) 
    df['name'] = df['name'].str.lower()
    return df

def code_processing(df, values_to_replace): 
    df['code'] = df['code'].replace(values_to_replace, np.nan) 
    df['code'] = pd.to_numeric(df['code'], errors='coerce')
    df['code'] = df['code'].apply(lambda x: np.nan if pd.isna(x) else int(round(x)))
    return df

def ingredients_processing(df, values_to_replace): 
    df['ingredients_temp'] = df['ingredients_temp'].replace("", np.nan)  # remplace vide par np.nan
    df['ingredients_temp'] = df['ingredients_temp'].apply(lambda x: x if isinstance(x, list) else []) # remplace np.nan par liste vide 
    df['ingredients_temp'] = df['ingredients_temp'].apply(lambda x: ', '.join(x)) # converti liste en string 
    def extract_en_ingredients(ingredient_list):     # extraire Ã©lÃ©ments avec 'en:' nouvelle colonne
        ingredients = ingredient_list.strip('[]').split(', ')
        return [ingredient.split(':')[-1] for ingredient in ingredients if ingredient.startswith('en:')] 
    df['ingredients'] = df['ingredients_temp'].apply(extract_en_ingredients)
    df.drop(columns=['ingredients_temp'], inplace=True)
    df['ingredients'] = df['ingredients'].apply(lambda x: ', '.join(x))
    df['ingredients'] = df['ingredients'].replace("", np.nan) 
    df['ingredients'] = df['ingredients'].replace(values_to_replace, np.nan) 
    return df

def packaging_processing(df, values_to_replace): 
    df['packaging'] = df['packaging'].replace("", np.nan)
    def remove_two_letters_and_colon(s):
        if isinstance(s, str):
            return re.sub(r'\b\w{2}:\b', '', s)
        return s
    df['packaging'] = df['packaging'].apply(remove_two_letters_and_colon)
    df['packaging'] = df['packaging'].astype(str)
    df['packaging'] = df['packaging'].str.lower()
    df['packaging'] = df['packaging'].replace(values_to_replace, np.nan) 
    return df

def categories_processing(df, values_to_replace): 
    df['categories_temp'] = df['categories_temp'].replace("", np.nan)  
    df['categories_temp'] = df['categories_temp'].apply(lambda x: x if isinstance(x, list) else [])
    df['categories_temp'] = df['categories_temp'].apply(lambda x: ', '.join(x))
    # extraire Ã©lÃ©ments avec 'en:' nouvelle colonne
    def extract_en_categories(categories_list):
        categories = categories_list.strip('[]').split(', ')
        return [categories.split(':')[-1] for categories in categories if categories.startswith('en:')]
    df['categories'] = df['categories_temp'].apply(extract_en_categories)
    df.drop(columns=['categories_temp'], inplace=True)
    df['categories'] = df['categories'].apply(lambda x: ', '.join(x))
    df['categories'] = df['categories'].replace("", np.nan)
    df['categories'] = df['categories'].replace(values_to_replace, np.nan) 
    return df

def delete_useless_lines(df, values_to_replace):
    df = df[~df['name'].isin(values_to_replace)]
    return df

def process_chunk(chunk, values_to_replace):
    df = chunk.copy()
    rename_columns_processing(df)
    groups_processing(df, values_to_replace)
    ingredients_processing(df, values_to_replace)
    packaging_processing(df, values_to_replace)
    ecoscore_tags_processing(df, values_to_replace)
    categories_processing(df, values_to_replace)
    #code_processing(df, values_to_replace)
    name_processing(df, values_to_replace)
    ecoscore_score_processing(df, values_to_replace)
    countries_processing(df, values_to_replace)
    labels_processing(df, values_to_replace)
    delete_useless_lines(df, values_to_replace)
    return df

# lecture et traitement du fichier jsonl en morceaux
def browse_file(estimated_chunks, jsonl_02, jsonl_03, chunk_size, values_to_replace):
    chunk_iter = 0
    with open(jsonl_02, 'r') as infile, open(jsonl_03, 'w') as outfile:
        for chunk in pd.read_json(infile, lines=True, chunksize=chunk_size):
            chunk_iter +=1
            processed_chunk = process_chunk(chunk, values_to_replace)
            processed_chunk.to_json(outfile, orient='records', lines=True)
            print(f"-----------------------------------------------------------> progress: {(chunk_iter * 100) / estimated_chunks} %")            



###############################################################################
# MAIN ########################################################################
###############################################################################
def main(chunk_size, file_id, data_path):
    chunk_size = int(chunk_size)
    jsonl_02 = data_path + file_id + '_openfoodfacts_02.jsonl' 
    jsonl_03 = data_path + file_id + '_openfoodfacts_03.jsonl' 
    values_to_replace = ["unknown", 
                         "Unknown", 
                         "None", 
                         "none", 
                         "", 
                         "not-applicable",
                         "nan",
                         "NaN"]
    print("estimating necessary chunk number")
    estimated_chunks = count_chunks(jsonl_02, chunk_size)
    print("browse throw jsonl 02 file to process columns")
    browse_file(estimated_chunks, jsonl_02, jsonl_03, chunk_size, values_to_replace)
    #print("deleting file jsonl 02")
    #delete_file(jsonl_02)

if __name__ == "__main__":
    chunk_size = sys.argv[1]
    file_id = sys.argv[2]
    data_path = sys.argv[3]
    main(chunk_size, file_id, data_path)